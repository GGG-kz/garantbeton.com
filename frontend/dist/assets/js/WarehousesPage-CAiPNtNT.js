import{j as e,a as s,P as t}from"./index-DssK2aQr.js";import{r as l}from"./vendor-CPG67Noa.js";import{M as a}from"./Modal-_SIwUgx5.js";import{J as o,_ as n,ab as r,z as i,a6 as d,Q as m,O as c,a as x,V as h,i as p}from"./ui-DT0cN5GG.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";function j({isOpen:s,onClose:t,onSave:a,warehouse:d,title:m}){const[c,x]=l.useState({name:"",address:"",coordinates:"",phone:"",materials:[],scalesComPort:"",scalesModel:"",scalesEnabled:!1}),[h,p]=l.useState({});l.useEffect(()=>{x(d?{name:d.name,address:d.address,coordinates:d.coordinates||"",phone:d.phone||"",materials:d.materials||[],scalesComPort:d.scalesComPort||"",scalesModel:d.scalesModel||"",scalesEnabled:d.scalesEnabled||!1}:{name:"",address:"",coordinates:"",phone:"",materials:[],scalesComPort:"",scalesModel:"",scalesEnabled:!1}),p({})},[d,s]);const j=(e,s)=>{x(t=>({...t,[e]:s})),h[e]&&p(s=>({...s,[e]:""}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={};c.name.trim()||(s.name="Название обязательно"),c.address.trim()||(s.address="Адрес обязателен"),Object.keys(s).length>0?p(s):(a(c),t())},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-mono-700 mb-2",children:"Название склада *"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),e.jsx("input",{type:"text",id:"name",value:c.name,onChange:e=>j("name",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(h.name?"border-red-300":"border-mono-300"),placeholder:"Основной склад"})]}),h.name&&e.jsx("p",{className:"mt-1 text-sm text-mono-600",children:h.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-mono-700 mb-2",children:"Адрес *"}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),e.jsx("input",{type:"text",id:"address",value:c.address,onChange:e=>j("address",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(h.address?"border-red-300":"border-mono-300"),placeholder:"г. Астана, ул. Промышленная, 15"})]}),h.address&&e.jsx("p",{className:"mt-1 text-sm text-mono-600",children:h.address})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coordinates",className:"block text-sm font-medium text-mono-700 mb-2",children:"Координаты для карт"}),e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),e.jsx("input",{type:"text",id:"coordinates",value:c.coordinates,onChange:e=>j("coordinates",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"51.1694, 71.4491 (широта, долгота)"})]}),e.jsx("p",{className:"mt-1 text-xs text-mono-500",children:"Можно скопировать из 2ГИС, Яндекс.Карт или Google Maps"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-mono-700 mb-2",children:"Телефон"}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),e.jsx("input",{type:"text",id:"phone",value:c.phone,onChange:e=>j("phone",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"+7 (7172) 123-45-67"})]})]})]}),e.jsxs("div",{className:"border-t border-mono-200 pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("span",{className:"text-2xl",children:"⚖️"}),e.jsx("h3",{className:"text-lg font-medium text-mono-900",children:"Настройки весов"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:c.scalesEnabled,onChange:e=>j("scalesEnabled",e.target.checked),className:"rounded border-mono-300 text-primary-600 focus:ring-primary-500 h-4 w-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-mono-700",children:"Включить весы на этом складе"}),e.jsx("p",{className:"text-xs text-mono-500",children:"Позволит автоматически взвешивать материалы при приемке"})]})]})}),c.scalesEnabled&&e.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-black mb-4",children:"Конфигурация весов"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"scalesComPort",className:"block text-sm font-medium text-mono-700 mb-2",children:"COM порт весов *"}),e.jsxs("select",{id:"scalesComPort",value:c.scalesComPort,onChange:e=>j("scalesComPort",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Выберите порт"}),e.jsx("option",{value:"COM1",children:"COM1"}),e.jsx("option",{value:"COM2",children:"COM2"}),e.jsx("option",{value:"COM3",children:"COM3"}),e.jsx("option",{value:"COM4",children:"COM4"}),e.jsx("option",{value:"COM5",children:"COM5"}),e.jsx("option",{value:"COM6",children:"COM6"}),e.jsx("option",{value:"COM7",children:"COM7"}),e.jsx("option",{value:"COM8",children:"COM8"})]}),e.jsx("p",{className:"text-xs text-mono-500 mt-1",children:"Порт к которому подключены весы"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"scalesModel",className:"block text-sm font-medium text-mono-700 mb-2",children:"Модель весов"}),e.jsx("input",{type:"text",id:"scalesModel",value:c.scalesModel,onChange:e=>j("scalesModel",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Например: CAS SW-1, Mettler Toledo, Avery Weigh-Tronix"}),e.jsx("p",{className:"text-xs text-mono-500 mt-1",children:"Модель весов для правильной настройки протокола"})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-white border border-mono-200 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-mono-900 mb-2",children:"Настройки по умолчанию:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-mono-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Скорость:"})," 9600 bps"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Данные:"})," 8N1"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Четность:"})," none"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Стоп-биты:"})," 1"]})]}),e.jsx("p",{className:"text-xs text-mono-500 mt-2",children:'Эти настройки будут использоваться автоматически. При необходимости их можно изменить в разделе "Настройки весов".'})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-mono-200",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Отмена"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors duration-200",children:"Сохранить"})]})]})})}const u=[];function b(){const[o,b]=s("warehouses",u),[f,N]=l.useState(""),[g,v]=l.useState(!1),[y,w]=l.useState(null),[C,M]=l.useState(null),k=o.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())||e.address.toLowerCase().includes(f.toLowerCase())),O=()=>{v(!1),w(null)};return e.jsxs(t,{title:"Склады",subtitle:"Управление складскими помещениями и запасами",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(d,{className:"h-8 w-8 text-black"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-mono-900",children:"Склады"}),e.jsxs("p",{className:"text-mono-600",children:["Всего: ",k.length]})]})]}),e.jsxs("button",{onClick:()=>{w(null),v(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors duration-200",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{children:"Добавить склад"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),e.jsx("input",{type:"text",placeholder:"Поиск по названию или адресу...",value:f,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-mono-600",children:"Всего складов"}),e.jsx("p",{className:"text-2xl font-bold text-mono-900",children:o.length})]}),e.jsx(d,{className:"h-8 w-8 text-black"})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-mono-600",children:"Активных складов"}),e.jsx("p",{className:"text-2xl font-bold text-mono-900",children:o.filter(e=>e.isActive).length})]}),e.jsx("div",{className:"h-8 w-8 bg-mono-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-mono-600 font-bold",children:"✓"})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:k.map(s=>e.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6 hover:shadow-lg transition-shadow duration-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-1",children:s.name}),e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-mono-100 text-black",children:"Активный"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>(e=>{M(e)})(s),className:"p-1 text-mono-400 hover:text-mono-600 transition-colors duration-200",title:"Просмотр",children:e.jsx(x,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>(e=>{w(e),v(!0)})(s),className:"p-1 text-mono-400 hover:text-black transition-colors duration-200",title:"Редактировать",children:e.jsx(h,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{return e=s.id,void(window.confirm("Вы уверены, что хотите удалить этот склад?")&&b(s=>s.filter(s=>s.id!==e)));var e},className:"p-1 text-mono-400 hover:text-mono-600 transition-colors duration-200",title:"Удалить",children:e.jsx(p,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-2 text-sm text-mono-600",children:[e.jsx(n,{className:"h-4 w-4 text-mono-400 mt-0.5"}),e.jsx("span",{children:s.address})]}),s.coordinates&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-mono-600",children:[e.jsx(r,{className:"h-4 w-4 text-mono-400"}),e.jsxs("span",{children:["Координаты: ",s.coordinates]})]}),s.phone&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-mono-600",children:[e.jsx(i,{className:"h-4 w-4 text-mono-400"}),e.jsx("span",{children:s.phone})]}),s.materials&&s.materials.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-mono-700 mb-2",children:"Хранимые материалы:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.materials.map((s,t)=>e.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-mono-100 text-black rounded",children:s},t))})]})]})]},s.id))}),0===k.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"mx-auto h-12 w-12 text-mono-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-mono-900",children:f?"Склады не найдены":"Нет складов"}),e.jsx("p",{className:"mt-2 text-mono-600",children:f?"Попробуйте изменить параметры поиска":"Добавьте первый склад для начала работы"})]})]}),e.jsx(a,{isOpen:g,onClose:O,title:y?"Редактировать склад":"Добавить склад",size:"lg",children:e.jsx(j,{isOpen:g,onClose:O,onSave:e=>{if(y)b(s=>s.map(s=>s.id===y.id?{...s,...e,updatedAt:(new Date).toISOString()}:s));else{const s={id:Date.now().toString(),...e,isActive:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};b(e=>[...e,s])}},warehouse:y,title:y?"Редактировать склад":"Добавить склад"})}),e.jsx(a,{isOpen:!!C,onClose:()=>M(null),title:"Просмотр склада",size:"md",children:C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Название"}),e.jsx("p",{className:"mt-1 text-sm text-mono-900",children:C.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Адрес"}),e.jsx("p",{className:"mt-1 text-sm text-mono-900",children:C.address})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Координаты"}),e.jsx("p",{className:"mt-1 text-sm text-mono-900",children:C.coordinates||"Не указаны"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Телефон"}),e.jsx("p",{className:"mt-1 text-sm text-mono-900",children:C.phone||"Не указан"})]})]}),C.materials&&C.materials.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Хранимые материалы"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:C.materials.map((s,t)=>e.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-mono-100 text-black rounded",children:s},t))})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-mono-200",children:e.jsx("button",{onClick:()=>M(null),className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Закрыть"})})]})})]})}export{b as default};
