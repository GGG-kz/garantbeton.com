import{a as e,j as s,P as t}from"./index-DssK2aQr.js";import{r as l}from"./vendor-CPG67Noa.js";import{M as o}from"./Modal-_SIwUgx5.js";import{ad as a,T as r,b as i,Q as n,O as c,a as d,V as m,i as x}from"./ui-DT0cN5GG.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";function p({isOpen:t,onClose:o,onSave:n,vehicle:c,title:d}){const[m]=e("drivers",[]),[x,p]=l.useState({type:"concrete_mixer",model:"",licensePlate:"",capacity:0,driverId:"",isHired:!1,status:"available"}),[u,h]=l.useState({});l.useEffect(()=>{p(c?{type:c.type,model:c.model,licensePlate:c.licensePlate,capacity:c.capacity,driverId:c.driverId||"",isHired:c.isHired,status:c.status}:{type:"concrete_mixer",model:"",licensePlate:"",capacity:0,driverId:"",isHired:!1,status:"available"}),h({})},[c,t]);const j=(e,s)=>{p(t=>({...t,[e]:s})),u[e]&&h(s=>({...s,[e]:""}))};return s.jsx("div",{className:"space-y-6",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={};x.model.trim()||(s.model="Модель обязательна"),x.licensePlate.trim()||(s.licensePlate="Госномер обязателен"),x.capacity<=0&&(s.capacity="Вместимость должна быть больше 0"),Object.keys(s).length>0?h(s):(n(x),o())},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-mono-700 mb-2",children:"Тип транспорта *"}),s.jsxs("select",{id:"type",value:x.type,onChange:e=>j("type",e.target.value),className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"concrete_mixer",children:"Автобетоносмеситель"}),s.jsx("option",{value:"dump_truck",children:"Самосвал"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-mono-700 mb-2",children:"Статус *"}),s.jsxs("select",{id:"status",value:x.status,onChange:e=>j("status",e.target.value),className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"available",children:"Доступен"}),s.jsx("option",{value:"in_use",children:"В работе"}),s.jsx("option",{value:"in_maintenance",children:"На обслуживании"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"model",className:"block text-sm font-medium text-mono-700 mb-2",children:"Модель *"}),s.jsxs("div",{className:"relative",children:[s.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"text",id:"model",value:x.model,onChange:e=>j("model",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(u.model?"border-red-300":"border-mono-300"),placeholder:"КАМАЗ-5320"})]}),u.model&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:u.model})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"licensePlate",className:"block text-sm font-medium text-mono-700 mb-2",children:"Госномер *"}),s.jsx("input",{type:"text",id:"licensePlate",value:x.licensePlate,onChange:e=>j("licensePlate",e.target.value.toUpperCase()),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(u.licensePlate?"border-red-300":"border-mono-300"),placeholder:"А123БВ77",style:{textTransform:"uppercase"}}),u.licensePlate&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:u.licensePlate})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.jsxs("div",{children:[s.jsx("label",{htmlFor:"capacity",className:"block text-sm font-medium text-mono-700 mb-2",children:"Вместимость *"}),s.jsxs("div",{className:"relative",children:[s.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"number",id:"capacity",value:x.capacity,onChange:e=>j("capacity",parseInt(e.target.value)||0),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(u.capacity?"border-red-300":"border-mono-300"),placeholder:"10",min:"1"})]}),s.jsx("p",{className:"mt-1 text-xs text-mono-500",children:"concrete_mixer"===x.type?"м³":"т"}),u.capacity&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:u.capacity})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"driverId",className:"block text-sm font-medium text-mono-700 mb-2",children:"Водитель"}),s.jsxs("div",{className:"relative",children:[s.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{id:"driverId",value:x.driverId,onChange:e=>j("driverId",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"",children:"Выберите водителя"}),m.filter(e=>e.isActive).map(e=>s.jsxs("option",{value:e.id,children:[e.fullName," (",e.phone,")"]},e.id))]})]})]}),s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"isHired",checked:x.isHired,onChange:e=>j("isHired",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-mono-300 rounded"}),s.jsx("label",{htmlFor:"isHired",className:"ml-2 block text-sm text-mono-900",children:"Наемный транспорт"})]})})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-mono-200",children:[s.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Отмена"}),s.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary-500 hover:bg-primary-600 rounded-lg transition-colors duration-200",children:"Сохранить"})]})]})})}const u=[];function h(){const[a,i]=e("vehicles",u),[h]=e("drivers",[]),[j,b]=l.useState(""),[g,v]=l.useState("all"),[f,N]=l.useState(!1),[y,w]=l.useState(null),[k,C]=l.useState(null),[_,P]=l.useState("all"),S=a.filter(e=>{const s=e.model.toLowerCase().includes(j.toLowerCase())||e.licensePlate.toLowerCase().includes(j.toLowerCase()),t="all"===g||e.type===g,l="all"===_||e.status===_;return s&&t&&l&&e.isActive}),I=e=>({concrete_mixer:"Автобетоносмеситель",dump_truck:"Самосвал"}[e]),H=e=>({available:"Доступен",in_use:"В работе",in_maintenance:"На обслуживании"}[e]),O=e=>{if(!e)return null;const s=h.find(s=>s.id===e);return s?s.fullName:"Неизвестный водитель"},F=()=>{N(!1),w(null)};return s.jsxs(t,{title:"Транспорт",subtitle:"Управление автобетоносмесителями и самосвалами",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(r,{className:"h-8 w-8 text-primary-600"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-mono-900",children:"Транспорт"}),s.jsxs("p",{className:"text-mono-600",children:["Всего: ",S.length]})]})]}),s.jsxs("button",{onClick:()=>{w(null),N(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors duration-200",children:[s.jsx(n,{className:"h-4 w-4"}),s.jsx("span",{children:"Добавить транспорт"})]})]}),s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"text",placeholder:"Поиск по названию, модели или госномеру...",value:j,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("span",{className:"text-sm text-mono-600 self-center",children:"Тип:"}),s.jsx("button",{onClick:()=>v("all"),className:"px-3 py-1 rounded-lg text-sm transition-colors duration-200 "+("all"===g?"bg-primary-500 text-white":"bg-mono-100 text-mono-700 hover:bg-mono-200"),children:"Все"}),s.jsx("button",{onClick:()=>v("concrete_mixer"),className:"px-3 py-1 rounded-lg text-sm transition-colors duration-200 "+("concrete_mixer"===g?"bg-primary-500 text-white":"bg-mono-100 text-mono-700 hover:bg-mono-200"),children:"АБС"}),s.jsx("button",{onClick:()=>v("dump_truck"),className:"px-3 py-1 rounded-lg text-sm transition-colors duration-200 "+("dump_truck"===g?"bg-primary-500 text-white":"bg-mono-100 text-mono-700 hover:bg-mono-200"),children:"Самосвалы"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("span",{className:"text-sm text-mono-600 self-center",children:"Статус:"}),s.jsx("button",{onClick:()=>P("all"),className:"px-3 py-1 rounded-lg text-sm transition-colors duration-200 "+("all"===_?"bg-primary-500 text-white":"bg-mono-100 text-mono-700 hover:bg-mono-200"),children:"Все"}),["active","maintenance","repair","inactive"].map(e=>s.jsx("button",{onClick:()=>P(e),className:"px-3 py-1 rounded-lg text-sm transition-colors duration-200 "+(_===e?"bg-primary-500 text-white":"bg-mono-100 text-mono-700 hover:bg-mono-200"),children:H(e)},e))]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:S.map(e=>{return s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6 hover:shadow-lg transition-shadow duration-200",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsxs("h3",{className:"text-lg font-semibold text-mono-900",children:[e.model," - ",e.licensePlate]}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${l=e.type,{concrete_mixer:"bg-mono-100 text-black",dump_truck:"bg-orange-100 text-orange-800"}[l]}`,children:I(e.type)}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t=e.status,{available:"bg-mono-100 text-green-800",in_use:"bg-mono-100 text-black",in_maintenance:"bg-yellow-100 text-yellow-800"}[t]}`,children:H(e.status)})]}),s.jsxs("div",{className:"text-sm text-mono-600",children:[s.jsx("p",{className:"font-medium",children:e.model}),s.jsxs("p",{children:["Госномер: ",e.licensePlate]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 mb-4",children:[s.jsx("button",{onClick:()=>(e=>{C(e)})(e),className:"p-2 text-mono-400 hover:text-mono-600 hover:bg-mono-100 rounded-lg transition-colors duration-200",title:"Просмотр",children:s.jsx(d,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>(e=>{w(e),N(!0)})(e),className:"p-2 text-mono-400 hover:text-black hover:bg-mono-50 rounded-lg transition-colors duration-200",title:"Редактировать",children:s.jsx(m,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>{return s=e.id,void(window.confirm("Вы уверены, что хотите удалить этот транспорт?")&&i(e=>e.filter(e=>e.id!==s)));var s},className:"p-2 text-mono-400 hover:text-mono-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Удалить",children:s.jsx(x,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-mono-50 p-3 rounded-lg",children:[s.jsx("p",{className:"text-sm text-mono-600 mb-1",children:"Вместимость"}),s.jsxs("p",{className:"text-lg font-semibold text-mono-900",children:[e.capacity," ","concrete_mixer"===e.type?"м³":"т"]})]}),(e.driverId||e.isHired)&&s.jsxs("div",{className:"space-y-2",children:[e.driverId&&s.jsxs("div",{className:"bg-mono-50 p-3 rounded-lg",children:[s.jsx("p",{className:"text-sm text-mono-600 mb-1",children:"Закрепленный водитель"}),s.jsx("p",{className:"text-sm font-medium text-black",children:O(e.driverId)})]}),e.isHired&&s.jsx("div",{className:"bg-orange-50 p-3 rounded-lg",children:s.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"🏢 Наемный транспорт"})})]})]})]},e.id);var t,l})}),0===S.length&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(r,{className:"mx-auto h-12 w-12 text-mono-400"}),s.jsx("h3",{className:"mt-4 text-lg font-medium text-mono-900",children:j||"all"!==g||"all"!==_?"Транспорт не найден":"Нет транспорта"}),s.jsx("p",{className:"mt-2 text-mono-600",children:j||"all"!==g||"all"!==_?"Попробуйте изменить параметры поиска":"Добавьте первый транспорт для начала работы"})]})]}),s.jsx(o,{isOpen:f,onClose:F,title:y?"Редактировать транспорт":"Добавить транспорт",size:"lg",children:s.jsx(p,{isOpen:f,onClose:F,onSave:e=>{if(y)i(s=>s.map(s=>s.id===y.id?{...s,...e,updatedAt:(new Date).toISOString()}:s));else{const s={id:Date.now().toString(),...e,isActive:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};i(e=>[...e,s])}},vehicle:y,title:y?"Редактировать транспорт":"Добавить транспорт"})}),s.jsx(o,{isOpen:!!k,onClose:()=>C(null),title:"Просмотр транспорта",size:"md",children:k&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Тип"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:I(k.type)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Статус"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:H(k.status)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Модель"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:k.model})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Госномер"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:k.licensePlate})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Вместимость"}),s.jsxs("p",{className:"mt-1 text-sm text-mono-900",children:[k.capacity," ","concrete_mixer"===k.type?"м³":"т"]})]}),k.driverId&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Закрепленный водитель"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:O(k.driverId)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"Тип владения"}),s.jsx("p",{className:"mt-1 text-sm text-mono-900",children:k.isHired?"🏢 Наемный транспорт":"🏭 Собственный транспорт"})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t border-mono-200",children:s.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Закрыть"})})]})})]})}export{h as default};
