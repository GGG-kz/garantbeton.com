import{u as e,j as s,a as t,P as r}from"./index-DssK2aQr.js";import{r as l}from"./vendor-CPG67Noa.js";import{M as n}from"./Modal-_SIwUgx5.js";import{F as a,P as o,A as i,N as c,b as d,q as m,W as x,G as p,l as h,j as u,t as j,U as g,Y as N,a as b,Q as f}from"./ui-DT0cN5GG.js";import{V as v}from"./ViewToggle-BZCXPk9z.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";const y={office_supplies:"Канцелярские товары",it_equipment:"IT оборудование",furniture:"Мебель",repairs:"Ремонт",cleaning:"Уборка",catering:"Питание",transport:"Транспорт",other:"Прочее"},w={pending:"На рассмотрении",priced:"Цена указана",approved:"Одобрено директором",paid:"Оплачено",rejected:"Отклонено",completed:"Выполнено",received:"Получено заявителем"},k={low:"Низкий",medium:"Средний",high:"Высокий",urgent:"Срочный"},S={pending:"bg-mono-100 text-mono-800",priced:"bg-mono-200 text-mono-900",approved:"bg-mono-300 text-black",paid:"bg-mono-400 text-black",rejected:"bg-mono-600 text-white",completed:"bg-black text-white",received:"bg-mono-500 text-white"},C={low:"bg-mono-100 text-mono-800",medium:"bg-mono-300 text-black",high:"bg-mono-600 text-white",urgent:"bg-black text-white"};function q({isOpen:t,onClose:r,onSave:i}){const{user:c}=e(),[d,m]=l.useState({category:"office_supplies",title:"",description:"",quantity:1,unit:"шт",status:"pending",priority:"medium",notes:""}),[x,p]=l.useState({}),h=(e,s)=>{m(t=>({...t,[e]:s})),x[e]&&p(s=>({...s,[e]:""}))},u=()=>{r(),p({})};return s.jsx(n,{isOpen:t,onClose:u,title:"Создать заявку",size:"lg",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={};d.title.trim()||(s.title="Название обязательно"),d.description.trim()||(s.description="Описание обязательно"),d.quantity&&d.quantity<=0&&(s.quantity="Количество должно быть больше 0"),Object.keys(s).length>0?p(s):(i(d),r(),m({category:"office_supplies",title:"",description:"",quantity:1,unit:"шт",status:"pending",priority:"medium",notes:""}),p({}))},className:"space-y-6",children:[s.jsxs("div",{className:"bg-mono-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(a,{className:"h-4 w-4 text-mono-600"}),s.jsx("span",{className:"text-sm font-medium text-mono-700",children:"Заявитель"})]}),s.jsx("p",{className:"text-sm text-mono-600",children:c?.fullName||c?.login})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-mono-700 mb-2",children:"Категория *"}),s.jsx("select",{id:"category",value:d.category,onChange:e=>h("category",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(x.category?"border-red-300":"border-mono-300"),children:Object.entries(y).map(([e,t])=>s.jsx("option",{value:e,children:t},e))}),x.category&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:x.category})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-mono-700 mb-2",children:"Приоритет"}),s.jsx("select",{id:"priority",value:d.priority,onChange:e=>h("priority",e.target.value),className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:Object.entries(k).map(([e,t])=>s.jsx("option",{value:e,children:t},e))})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-mono-700 mb-2",children:"Название заявки *"}),s.jsx("input",{type:"text",id:"title",value:d.title,onChange:e=>h("title",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(x.title?"border-red-300":"border-mono-300"),placeholder:"Краткое описание заявки"}),x.title&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:x.title})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-mono-700 mb-2",children:"Описание *"}),s.jsx("textarea",{id:"description",value:d.description,onChange:e=>h("description",e.target.value),rows:4,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(x.description?"border-red-300":"border-mono-300"),placeholder:"Подробное описание заявки"}),x.description&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:x.description})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-mono-700 mb-2",children:"Количество"}),s.jsxs("div",{className:"relative",children:[s.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"number",id:"quantity",value:d.quantity||"",onChange:e=>h("quantity",parseInt(e.target.value)||1),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(x.quantity?"border-red-300":"border-mono-300"),placeholder:"1",min:"1"})]}),x.quantity&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:x.quantity})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"unit",className:"block text-sm font-medium text-mono-700 mb-2",children:"Единица измерения"}),s.jsxs("select",{id:"unit",value:d.unit||"шт",onChange:e=>h("unit",e.target.value),className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"шт",children:"Штук"}),s.jsx("option",{value:"комплект",children:"Комплект"}),s.jsx("option",{value:"упаковка",children:"Упаковка"}),s.jsx("option",{value:"кг",children:"Килограмм"}),s.jsx("option",{value:"л",children:"Литр"}),s.jsx("option",{value:"м",children:"Метр"}),s.jsx("option",{value:"м²",children:"Квадратный метр"}),s.jsx("option",{value:"м³",children:"Кубический метр"}),s.jsx("option",{value:"час",children:"Час"}),s.jsx("option",{value:"день",children:"День"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-mono-700 mb-2",children:"Дополнительные примечания"}),s.jsx("textarea",{id:"notes",value:d.notes||"",onChange:e=>h("notes",e.target.value),rows:3,className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Дополнительная информация (необязательно)"})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-mono-200",children:[s.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Отмена"}),s.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary-500 hover:bg-primary-600 rounded-lg transition-colors duration-200",children:"Создать заявку"})]})]})})}function O({requests:e,viewMode:t,onRefresh:r,onMarkAsReceived:n}){const[j,g]=l.useState("all"),[N,b]=l.useState("all"),f=e.filter(e=>{const s="all"===j||e.status===j,t="all"===N||e.category===N;return s&&t}),v=e=>{switch(e){case"pending":default:return s.jsx(p,{className:"h-4 w-4"});case"priced":return s.jsx(o,{className:"h-4 w-4"});case"approved":case"completed":return s.jsx(h,{className:"h-4 w-4"});case"paid":return s.jsx(m,{className:"h-4 w-4"});case"rejected":return s.jsx(u,{className:"h-4 w-4"});case"received":return s.jsx(x,{className:"h-4 w-4"})}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"Статус"}),s.jsxs("select",{value:j,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"all",children:"Все статусы"}),Object.entries(w).map(([e,t])=>s.jsx("option",{value:e,children:t},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"Категория"}),s.jsxs("select",{value:N,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"all",children:"Все категории"}),Object.entries(y).map(([e,t])=>s.jsx("option",{value:e,children:t},e))]})]})]})}),0===f.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(a,{className:"h-12 w-12 text-mono-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-mono-900 mb-2",children:"Заявок не найдено"}),s.jsx("p",{className:"text-mono-500",children:0===e.length?"У вас пока нет заявок":"Попробуйте изменить фильтры"})]}):"list"===t?s.jsx("div",{className:"space-y-4",children:f.map(e=>s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6 hover:shadow-md transition-shadow duration-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-2",children:e.title}),s.jsx("p",{className:"text-sm text-mono-600 mb-3",children:e.description})]}),s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S[e.status]}`,children:[v(e.status),s.jsx("span",{className:"ml-1",children:w[e.status]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center text-mono-600",children:[s.jsx(o,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{children:y[e.category]})]}),s.jsxs("div",{className:"flex items-center text-mono-600",children:[s.jsx(i,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{className:C[e.priority],children:k[e.priority]})]}),s.jsxs("div",{className:"flex items-center text-mono-600",children:[s.jsx(c,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{children:new Date(e.createdAt).toLocaleDateString("ru-RU")})]})]}),e.counterpartyName&&s.jsxs("div",{className:"mt-3 p-3 bg-mono-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center text-sm text-mono-700 mb-1",children:[s.jsx(d,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("strong",{children:"Контрагент:"})]}),s.jsx("p",{className:"text-sm text-mono-700 ml-6",children:e.counterpartyName})]}),e.price&&s.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center text-sm text-mono-700 mb-1",children:[s.jsx(m,{className:"h-4 w-4 text-green-400 mr-2"}),s.jsx("strong",{children:"Цена:"})]}),s.jsxs("p",{className:"text-lg font-semibold text-green-800 ml-6",children:[e.price.toLocaleString("ru-RU")," ₸"]})]}),e.notes&&s.jsx("div",{className:"mt-3 p-3 bg-mono-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-mono-700",children:[s.jsx("strong",{children:"Примечания:"})," ",e.notes]})}),"completed"===e.status&&n&&s.jsx("div",{className:"mt-4 pt-4 border-t border-mono-200",children:s.jsxs("button",{onClick:()=>n(e.id),className:"w-full bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors duration-200 flex items-center justify-center",children:[s.jsx(x,{className:"h-4 w-4 mr-2"}),"Отметить получение"]})})]},e.id))}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(e=>s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6 hover:shadow-lg transition-shadow duration-200 relative",children:[s.jsx("div",{className:"absolute top-4 right-4",children:s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${S[e.status]}`,children:[v(e.status),s.jsx("span",{className:"ml-1",children:w[e.status]})]})}),s.jsxs("div",{className:"mb-4 pr-20",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-2 truncate",children:e.title}),s.jsx("p",{className:"text-sm text-mono-600 line-clamp-2",children:e.description})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(o,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{children:y[e.category]})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(i,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{className:C[e.priority],children:k[e.priority]})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(c,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Создано: ",new Date(e.createdAt).toLocaleDateString("ru-RU")]})]}),e.counterpartyName&&s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(d,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Контрагент: ",e.counterpartyName]})]}),e.price&&s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(m,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Цена: ",e.price.toLocaleString("ru-RU")," ₸"]})]})]}),"completed"===e.status&&n&&s.jsx("div",{className:"mt-4 pt-4 border-t border-mono-200",children:s.jsxs("button",{onClick:()=>n(e.id),className:"w-full bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors duration-200 flex items-center justify-center",children:[s.jsx(x,{className:"h-4 w-4 mr-2"}),"Отметить получение"]})})]},e.id))}),e.length>0&&s.jsxs("div",{className:"bg-mono-50 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-mono-700 mb-2",children:"Статистика ваших заявок"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-900",children:e.length}),s.jsx("div",{className:"text-mono-600",children:"Всего"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-600",children:e.filter(e=>"pending"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"На рассмотрении"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-black",children:e.filter(e=>"priced"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Оценено"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-600",children:e.filter(e=>"approved"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Одобрено"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.filter(e=>"completed"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Выполнено"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:e.filter(e=>"received"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Получено"})]})]})]})]})}function R({isOpen:e,onClose:t,onSetPrice:r,request:a}){const[i,c]=l.useState(0),[d,x]=l.useState(""),[p,h]=l.useState({}),u=()=>{t(),h({}),c(0),x("")};return a?s.jsx(n,{isOpen:e,onClose:u,title:"Установить цену",size:"md",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={};i<=0&&(s.price="Цена должна быть больше 0"),Object.keys(s).length>0?h(s):a&&(r(a.id,i,d),t(),c(0),x(""),h({}))},className:"space-y-6",children:[s.jsxs("div",{className:"bg-mono-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(o,{className:"h-4 w-4 text-mono-600"}),s.jsx("span",{className:"text-sm font-medium text-mono-700",children:"Заявка"})]}),s.jsx("h4",{className:"font-medium text-mono-900",children:a.title}),s.jsx("p",{className:"text-sm text-mono-600 mt-1",children:a.description}),a.quantity&&s.jsxs("p",{className:"text-sm text-mono-500 mt-1",children:["Количество: ",a.quantity," ",a.unit]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-mono-700 mb-2",children:"Цена (₸) *"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"number",id:"price",value:i||"",onChange:e=>{c(parseFloat(e.target.value)||0),p.price&&h(e=>({...e,price:""}))},className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(p.price?"border-red-300":"border-mono-300"),placeholder:"0",min:"0",step:"0.01"})]}),p.price&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:p.price})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-mono-700 mb-2",children:"Примечания к цене"}),s.jsx("textarea",{id:"notes",value:d,onChange:e=>x(e.target.value),rows:3,className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Дополнительная информация о цене (опционально)"})]}),i>0&&a.quantity&&s.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(j,{className:"h-4 w-4 text-black"}),s.jsx("span",{className:"text-sm font-medium text-black",children:"Предварительный расчет"})]}),s.jsxs("div",{className:"text-sm text-black",children:[s.jsxs("p",{children:["Цена за единицу: ",s.jsxs("strong",{children:[i.toLocaleString("ru-RU")," ₸"]})]}),s.jsxs("p",{children:["Количество: ",s.jsxs("strong",{children:[a.quantity," ",a.unit]})]}),s.jsxs("p",{className:"font-semibold text-black mt-1",children:["Общая сумма: ",s.jsxs("strong",{children:[(i*a.quantity).toLocaleString("ru-RU")," ₸"]})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-mono-200",children:[s.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Отмена"}),s.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary-500 hover:bg-primary-600 rounded-lg transition-colors duration-200",children:"Установить цену и одобрить"})]})]})}):null}function D({isOpen:e,onClose:r,onSetDetails:a,request:i}){const[c]=t("counterparties",[]),[d,x]=l.useState(""),[p,h]=l.useState(0),[u,j]=l.useState(""),[N,b]=l.useState({}),f=()=>{r(),b({}),x(""),h(0),j("")};return i?s.jsx(n,{isOpen:e,onClose:f,title:"Указать поставщика и цену",size:"lg",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={};if(d||(s.counterpartyId="Выберите поставщика"),p<=0&&(s.price="Цена должна быть больше 0"),Object.keys(s).length>0)b(s);else if(i){const e=c.find(e=>e.id===d),s=e?e.name:"Неизвестный поставщик";a(i.id,d,s,p,u),r(),x(""),h(0),j(""),b({})}},className:"space-y-6",children:[s.jsxs("div",{className:"bg-mono-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(o,{className:"h-4 w-4 text-mono-600"}),s.jsx("span",{className:"text-sm font-medium text-mono-700",children:"Заявка"})]}),s.jsx("h4",{className:"font-medium text-mono-900",children:i.title}),s.jsx("p",{className:"text-sm text-mono-600 mt-1",children:i.description}),i.quantity&&s.jsxs("p",{className:"text-sm text-mono-500 mt-1",children:["Количество: ",i.quantity," ",i.unit]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"counterpartyId",className:"block text-sm font-medium text-mono-700 mb-2",children:"Поставщик *"}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{id:"counterpartyId",value:d,onChange:e=>{x(e.target.value),N.counterpartyId&&b(e=>({...e,counterpartyId:""}))},className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(N.counterpartyId?"border-red-300":"border-mono-300"),children:[s.jsx("option",{value:"",children:"Выберите поставщика"}),c.filter(e=>"supplier"===e.type&&e.isActive).map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),N.counterpartyId&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:N.counterpartyId})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-mono-700 mb-2",children:"Цена (₸) *"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"number",id:"price",value:p||"",onChange:e=>{h(parseFloat(e.target.value)||0),N.price&&b(e=>({...e,price:""}))},className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 "+(N.price?"border-red-300":"border-mono-300"),placeholder:"0",min:"0",step:"0.01"})]}),N.price&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:N.price})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-mono-700 mb-2",children:"Примечания к заказу"}),s.jsx("textarea",{id:"notes",value:u,onChange:e=>j(e.target.value),rows:3,className:"w-full px-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Дополнительная информация о заказе (опционально)"})]}),p>0&&i.quantity&&s.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(m,{className:"h-4 w-4 text-black"}),s.jsx("span",{className:"text-sm font-medium text-black",children:"Предварительный расчет"})]}),s.jsxs("div",{className:"text-sm text-black",children:[s.jsxs("p",{children:["Цена за единицу: ",s.jsxs("strong",{children:[p.toLocaleString("ru-RU")," ₸"]})]}),s.jsxs("p",{children:["Количество: ",s.jsxs("strong",{children:[i.quantity," ",i.unit]})]}),s.jsxs("p",{className:"font-semibold text-black mt-1",children:["Общая сумма: ",s.jsxs("strong",{children:[(p*i.quantity).toLocaleString("ru-RU")," ₸"]})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-mono-200",children:[s.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-sm font-medium text-mono-700 bg-mono-100 hover:bg-mono-200 rounded-lg transition-colors duration-200",children:"Отмена"}),s.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary-500 hover:bg-primary-600 rounded-lg transition-colors duration-200",children:"Указать поставщика и цену"})]})]})}):null}function I({requests:e,viewMode:t,onUpdateRequest:r,onRefresh:n,userRole:a}){const[i,x]=l.useState("all"),[j,g]=l.useState("all"),[f,v]=l.useState("all"),[q,O]=l.useState(""),[I,A]=l.useState(null),[L,U]=l.useState(!1),[F,$]=l.useState(null),[B,M]=l.useState(!1),[z,P]=l.useState(null),T="supply"===a,V="director"===a,_="accountant"===a,G="supply"===a,K=e.filter(e=>{const s="all"===i||e.status===i,t="all"===j||e.category===j,r="all"===f||e.priority===f,l=""===q||e.title.toLowerCase().includes(q.toLowerCase())||e.description.toLowerCase().includes(q.toLowerCase())||e.userName.toLowerCase().includes(q.toLowerCase());return s&&t&&r&&l}),Q=(e,s)=>{const t={status:s,updatedAt:(new Date).toISOString()};"approved"!==s&&"completed"!==s||(t.approvedBy="Текущий пользователь",t.approvedAt=(new Date).toISOString()),"completed"===s&&(t.completedBy="Текущий пользователь",t.completedAt=(new Date).toISOString()),r(e,t)},W=(e,s)=>{Q(e,s)},Y=e=>new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),Z=e=>{switch(e){case"pending":default:return s.jsx(p,{className:"h-4 w-4"});case"approved":case"completed":return s.jsx(h,{className:"h-4 w-4"});case"rejected":return s.jsx(u,{className:"h-4 w-4"})}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:[s.jsx(N,{className:"inline-block h-4 w-4 mr-1"}),"Статус"]}),s.jsxs("select",{value:i,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"all",children:"Все статусы"}),Object.entries(w).map(([e,t])=>s.jsx("option",{value:e,children:t},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"Категория"}),s.jsxs("select",{value:j,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"all",children:"Все категории"}),Object.entries(y).map(([e,t])=>s.jsx("option",{value:e,children:t},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"Приоритет"}),s.jsxs("select",{value:f,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"all",children:"Все приоритеты"}),Object.entries(k).map(([e,t])=>s.jsx("option",{value:e,children:t},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"Поиск"}),s.jsx("input",{type:"text",value:q,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Поиск по названию, описанию или заявителю..."})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center p-3 bg-mono-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-900",children:K.length}),s.jsx("div",{className:"text-mono-600",children:"Найдено"})]}),s.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-600",children:K.filter(e=>"pending"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"На рассмотрении"})]}),s.jsxs("div",{className:"text-center p-3 bg-mono-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-black",children:K.filter(e=>"approved"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Одобрено"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:K.filter(e=>"paid"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Оплачено"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-mono-600",children:K.filter(e=>"completed"===e.status).length}),s.jsx("div",{className:"text-mono-600",children:"Выполнено"})]})]})]}),"list"===t?s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-mono-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Заявка"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Заявитель"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Категория"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Статус"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Приоритет"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Дата создания"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-mono-500 uppercase tracking-wider",children:"Действия"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(e=>s.jsxs("tr",{className:"hover:bg-mono-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx(o,{className:"h-10 w-10 text-mono-400"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-mono-900 max-w-xs truncate",children:e.title}),s.jsx("div",{className:"text-sm text-mono-500 max-w-xs truncate",children:e.description}),e.quantity&&s.jsxs("div",{className:"text-xs text-mono-400",children:[e.quantity," ",e.unit]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(d,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("div",{className:"text-sm text-mono-900",children:e.userName})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-mono-900",children:y[e.category]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S[e.status]}`,children:[Z(e.status),s.jsx("span",{className:"ml-1",children:w[e.status]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${C[e.priority]}`,children:k[e.priority]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center text-sm text-mono-500",children:[s.jsx(c,{className:"h-4 w-4 mr-1"}),Y(e.createdAt)]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>A(e),className:"text-primary-600 hover:text-primary-900",title:"Просмотр деталей",children:s.jsx(b,{className:"h-4 w-4"})}),T&&"pending"===e.status&&s.jsx("button",{onClick:()=>(e=>{P(e),M(!0)})(e),className:"text-orange-600 hover:text-orange-900",title:"Указать поставщика и цену",children:s.jsx(o,{className:"h-4 w-4"})}),V&&"priced"===e.status&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Q(e.id,"approved"),className:"text-mono-600 hover:text-green-900",title:"Одобрить заявку",children:s.jsx(h,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>Q(e.id,"rejected"),className:"text-mono-600 hover:text-red-900",title:"Отклонить заявку",children:s.jsx(u,{className:"h-4 w-4"})})]}),_&&"approved"===e.status&&s.jsx("button",{onClick:()=>(e=>{const s={status:"paid",updatedAt:(new Date).toISOString(),paidBy:"Бухгалтер",paidAt:(new Date).toISOString()};r(e,s)})(e.id),className:"text-purple-600 hover:text-purple-900",title:"Оплатить заказ",children:s.jsx(m,{className:"h-4 w-4"})}),G&&"paid"===e.status&&s.jsx("button",{onClick:()=>Q(e.id,"completed"),className:"text-mono-600 hover:text-green-900",title:"Отметить как выполненное",children:s.jsx(h,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===K.length&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(o,{className:"h-12 w-12 text-mono-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-mono-900 mb-2",children:"Заявок не найдено"}),s.jsx("p",{className:"text-mono-500",children:0===e.length?"Пока нет заявок":"Попробуйте изменить фильтры или поисковый запрос"})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(e=>s.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6 hover:shadow-lg transition-shadow duration-200 relative",children:[s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${S[e.status]}`,children:w[e.status]})}),s.jsxs("div",{className:"mb-4 pr-20",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-2 truncate",children:e.title}),s.jsx("p",{className:"text-sm text-mono-600 line-clamp-2",children:e.description})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(d,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{children:e.userName})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(o,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsx("span",{children:y[e.category]})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(c,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Создано: ",new Date(e.createdAt).toLocaleDateString("ru-RU")]})]}),s.jsx("div",{className:"flex items-center text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${C[e.priority]}`,children:k[e.priority]})}),e.counterpartyName&&s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(m,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Контрагент: ",e.counterpartyName]})]}),e.price&&s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(m,{className:"h-4 w-4 text-mono-400 mr-2"}),s.jsxs("span",{children:["Цена: ",e.price.toLocaleString("ru-RU")," ₸"]})]})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-mono-200 flex gap-2",children:["supply"===a&&"pending"===e.status&&s.jsx("button",{onClick:()=>P(e),className:"flex-1 bg-black text-white px-3 py-2 rounded text-sm hover:bg-black transition-colors duration-200",children:"Указать поставщика"}),"director"===a&&"priced"===e.status&&s.jsx("button",{onClick:()=>W(e.id,"approved"),className:"flex-1 bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700 transition-colors duration-200",children:"Одобрить"}),"accountant"===a&&"approved"===e.status&&s.jsx("button",{onClick:()=>W(e.id,"paid"),className:"flex-1 bg-purple-600 text-white px-3 py-2 rounded text-sm hover:bg-purple-700 transition-colors duration-200",children:"Оплатить"}),("supply"===a||"director"===a)&&"paid"===e.status&&s.jsx("button",{onClick:()=>W(e.id,"completed"),className:"flex-1 bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700 transition-colors duration-200",children:"Выполнить"})]})]},e.id))}),I&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-mono-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900",children:"Детали заявки"}),s.jsx("button",{onClick:()=>A(null),className:"text-mono-400 hover:text-mono-600",children:s.jsx(u,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-mono-900 mb-2",children:I.title}),s.jsx("p",{className:"text-mono-700",children:I.description})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Заявитель:"}),s.jsx("span",{className:"ml-2 text-mono-900",children:I.userName})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Категория:"}),s.jsx("span",{className:"ml-2 text-mono-900",children:y[I.category]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Статус:"}),s.jsxs("span",{className:`ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S[I.status]}`,children:[Z(I.status),s.jsx("span",{className:"ml-1",children:w[I.status]})]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Приоритет:"}),s.jsx("span",{className:`ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${C[I.priority]}`,children:k[I.priority]})]}),I.quantity&&s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Количество:"}),s.jsxs("span",{className:"ml-2 text-mono-900",children:[I.quantity," ",I.unit]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Дата создания:"}),s.jsx("span",{className:"ml-2 text-mono-900",children:Y(I.createdAt)})]})]}),I.notes&&s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-mono-700",children:"Примечания:"}),s.jsx("p",{className:"mt-1 text-mono-900",children:I.notes})]}),I.approvedBy&&s.jsxs("div",{className:"bg-mono-50 p-3 rounded-lg",children:[s.jsx("span",{className:"font-medium text-black",children:"Одобрено:"}),s.jsxs("p",{className:"text-black",children:[I.approvedBy," - ",Y(I.approvedAt)]})]}),I.completedBy&&s.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[s.jsx("span",{className:"font-medium text-green-900",children:"Выполнено:"}),s.jsxs("p",{className:"text-mono-700",children:[I.completedBy," - ",Y(I.completedAt)]})]})]})]})}),s.jsx(R,{isOpen:L,onClose:()=>{U(!1),$(null)},onSetPrice:(e,s,t)=>{const l={status:"approved",updatedAt:(new Date).toISOString(),approvedBy:"Бухгалтер",approvedAt:(new Date).toISOString(),notes:t?`${t} | Цена: ${s.toLocaleString("ru-RU")} ₸`:`Цена: ${s.toLocaleString("ru-RU")} ₸`};r(e,l)},request:F}),s.jsx(D,{isOpen:B,onClose:()=>{M(!1),P(null)},onSetDetails:(e,s,t,l,n)=>{const a={status:"priced",counterpartyId:s,counterpartyName:t,price:l,currency:"KZT",updatedAt:(new Date).toISOString(),notes:n?`${n} | Поставщик: ${t} | Цена: ${l.toLocaleString("ru-RU")} ₸`:`Поставщик: ${t} | Цена: ${l.toLocaleString("ru-RU")} ₸`};r(e,a)},request:z})]})}const A=[];function L(){const{user:n}=e(),[o,i]=t("internalRequests",A),[c,d]=t("requestsViewMode","list"),[m,x]=l.useState(!1),p=!!n,u=n&&["director","accountant","supply"].includes(n.role),j=u?o:o.filter(e=>e.userRole===n?.role),N=()=>{};return n?p?s.jsxs(r,{title:"Внутренние заявки",subtitle:u?"Управление всеми заявками сотрудников":"Ваши заявки на внутренние нужды",showBackButton:!0,children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"p-3 bg-mono-100 rounded-lg",children:s.jsx(a,{className:"h-6 w-6 text-black"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-black",children:u?"Все заявки":"Мои заявки"}),s.jsx("p",{className:"text-mono-600",children:u?"Управление заявками всех сотрудников":"Создавайте и отслеживайте свои заявки"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(v,{viewMode:c,onViewModeChange:d}),s.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors duration-200",children:[s.jsx(f,{className:"h-4 w-4"}),s.jsx("span",{children:"Создать заявку"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-mono-600",children:"Всего заявок"}),s.jsx("p",{className:"text-2xl font-bold text-black",children:j.length})]}),s.jsx(a,{className:"h-8 w-8 text-black"})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-mono-600",children:"На рассмотрении"}),s.jsx("p",{className:"text-2xl font-bold text-mono-800",children:j.filter(e=>"pending"===e.status).length})]}),s.jsx("div",{className:"h-8 w-8 bg-mono-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-mono-800 font-bold",children:"⏳"})})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-mono-600",children:"Одобрено"}),s.jsx("p",{className:"text-2xl font-bold text-mono-700",children:j.filter(e=>"approved"===e.status).length})]}),s.jsx("div",{className:"h-8 w-8 bg-mono-100 rounded-full flex items-center justify-center",children:s.jsx(h,{className:"h-5 w-5 text-mono-700"})})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-mono-600",children:"Оплачено"}),s.jsx("p",{className:"text-2xl font-bold text-mono-800",children:j.filter(e=>"paid"===e.status).length})]}),s.jsx("div",{className:"h-8 w-8 bg-mono-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-mono-800 font-bold",children:"₸"})})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-mono-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-mono-600",children:"Выполнено"}),s.jsx("p",{className:"text-2xl font-bold text-mono-900",children:j.filter(e=>"completed"===e.status).length})]}),s.jsx("div",{className:"h-8 w-8 bg-mono-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-mono-900 font-bold",children:"✓"})})]})})]}),u?s.jsx(I,{requests:j,viewMode:c,onUpdateRequest:(e,s)=>{i(t=>t.map(t=>t.id===e?{...t,...s}:t))},onRefresh:N,userRole:n.role}):s.jsx(O,{requests:j,viewMode:c,onRefresh:N,onMarkAsReceived:e=>{n&&window.confirm("Вы подтверждаете, что получили товар/услугу по данной заявке?")&&i(s=>s.map(s=>s.id===e?{...s,status:"received",receivedBy:n.id,receivedAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}:s))}}),u?s.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"font-medium text-black mb-2 flex items-center",children:[s.jsx(g,{className:"h-4 w-4 mr-2"}),"Управление заявками"]}),s.jsxs("div",{className:"text-sm text-mono-700 space-y-2",children:["supply"===n.role&&s.jsxs("p",{children:["Как ",s.jsx("strong",{children:"снабженец"}),", вы можете ",s.jsx("strong",{children:"указывать поставщика и цену"})," для заявок, а также ",s.jsx("strong",{children:"выполнять заказы"})," после их оплаты."]}),"director"===n.role&&s.jsxs("p",{children:["Как ",s.jsx("strong",{children:"директор"}),", вы можете ",s.jsx("strong",{children:"одобрять или отклонять"})," заявки после указания цены снабженцем."]}),"accountant"===n.role&&s.jsxs("p",{children:["Как ",s.jsx("strong",{children:"бухгалтер"}),", вы можете ",s.jsx("strong",{children:"оплачивать заказы"})," после их одобрения директором."]}),s.jsx("p",{children:"Используйте фильтры для быстрого поиска нужных заявок."})]})]}):s.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"font-medium text-black mb-2 flex items-center",children:[s.jsx(a,{className:"h-4 w-4 mr-2"}),"О внутренних заявках"]}),s.jsxs("div",{className:"text-sm text-mono-700 space-y-2",children:[s.jsx("p",{children:"Создавайте заявки на внутренние нужды: канцелярские товары, IT оборудование, ремонт, уборку и другие потребности."}),s.jsxs("p",{children:[s.jsx("strong",{children:"Конфиденциальность:"})," Вы видите только свои заявки. Заявки других сотрудников (менеджера, диспетчера, водителя и т.д.) вам недоступны."]}),s.jsx("p",{children:"Отслеживайте статус ваших заявок и получайте уведомления об изменениях."})]})]})]}),s.jsx(q,{isOpen:m,onClose:()=>x(!1),onSave:e=>{if(!n)return;const s={...e,id:Date.now().toString(),userId:n.id,userName:n.fullName||n.login,userRole:n.role,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isActive:!0};i(e=>[s,...e])}})]}):s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-black mb-4",children:"Доступ запрещен"}),s.jsx("p",{className:"text-mono-600 mb-4",children:"Доступ к внутренним заявкам имеют только:"}),s.jsxs("div",{className:"text-sm text-mono-500 space-y-1",children:[s.jsx("p",{children:"• Директор"}),s.jsx("p",{children:"• Бухгалтер"}),s.jsx("p",{children:"• Снабженец"}),s.jsx("p",{children:"• Авторы заявок"})]})]})}):s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-black mb-4",children:"Доступ запрещен"}),s.jsx("p",{className:"text-mono-600",children:"Необходимо войти в систему"})]})})}export{L as default};
