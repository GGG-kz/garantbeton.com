import{u as e,a as s,j as t,P as l}from"./index-DssK2aQr.js";import{r as o}from"./vendor-CPG67Noa.js";import{b as i,z as r,K as n,u as a,l as c,G as d,k as m,j as x}from"./ui-DT0cN5GG.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";function h(){const{user:h}=e(),[b,j]=s("drivers",[]),[p,u]=o.useState(null),[g,N]=o.useState(!1);o.useEffect(()=>{if(h?.login){const e=b.find(e=>e.login===h.login);u(e||null)}},[h,b]);const f=e=>{if(!p)return;const s={...p,status:e,updatedAt:(new Date).toISOString()};j(e=>e.map(e=>e.id===p.id?s:e)),u(s),N(!1)},v=e=>({active:{label:"Доступен",icon:c,color:"text-mono-600",bgColor:"bg-green-50",description:"Готов к работе"},vacation:{label:"В отпуске",icon:d,color:"text-black",bgColor:"bg-mono-50",description:"Находится в отпуске"},sick:{label:"На больничном",icon:m,color:"text-mono-600",bgColor:"bg-yellow-50",description:"На больничном листе"},inactive:{label:"Неактивен",icon:x,color:"text-mono-600",bgColor:"bg-red-50",description:"Временно недоступен"}}[e]);if(!h||"driver"!==h.role)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-2xl font-bold text-mono-900 mb-4",children:"Доступ запрещен"}),t.jsx("p",{className:"text-mono-600",children:"Эта страница доступна только водителям"})]})});if(!p)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-2xl font-bold text-mono-900 mb-4",children:"Водитель не найден"}),t.jsx("p",{className:"text-mono-600",children:"Информация о водителе не найдена в системе"})]})});const y=v(p.status),w=y.icon;return t.jsx(l,{title:"Личный кабинет водителя",subtitle:"Управление статусом и личной информацией",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-mono-900 mb-4 flex items-center",children:[t.jsx(i,{className:"h-5 w-5 mr-2 text-primary-600"}),"Личная информация"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"ФИО"}),t.jsx("p",{className:"text-sm text-mono-900",children:p.fullName})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-mono-700 mb-1 flex items-center",children:[t.jsx(r,{className:"h-4 w-4 mr-1"}),"Телефон"]}),t.jsx("p",{className:"text-sm text-mono-900",children:p.phone})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-mono-700 mb-1 flex items-center",children:[t.jsx(n,{className:"h-4 w-4 mr-1"}),"Логин"]}),t.jsx("p",{className:"text-sm text-mono-900",children:p.login})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Дата создания"}),t.jsx("p",{className:"text-sm text-mono-900",children:new Date(p.createdAt).toLocaleDateString("kk-KZ")})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-mono-900 mb-4 flex items-center",children:[t.jsx(a,{className:"h-5 w-5 mr-2 text-primary-600"}),"Текущий статус"]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`p-3 rounded-full ${y.bgColor}`,children:t.jsx(w,{className:`h-6 w-6 ${y.color}`})}),t.jsxs("div",{children:[t.jsx("p",{className:`font-medium ${y.color}`,children:y.label}),t.jsx("p",{className:"text-sm text-mono-600",children:y.description})]})]}),t.jsx("button",{onClick:()=>N(!g),className:"px-4 py-2 text-sm font-medium text-primary-600 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors duration-200",children:"Изменить"})]}),g&&t.jsxs("div",{className:"mt-6 p-4 bg-mono-50 rounded-lg",children:[t.jsx("h4",{className:"text-sm font-medium text-mono-900 mb-3",children:"Выберите новый статус:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:["active","vacation","sick","inactive"].map(e=>{const s=v(e),l=s.icon,o=e===p.status;return t.jsxs("button",{onClick:()=>f(e),disabled:o,className:"p-3 rounded-lg border-2 transition-colors duration-200 flex items-center space-x-3 "+(o?"border-primary-500 bg-primary-50":"border-mono-200 hover:border-primary-300 hover:bg-primary-50"),children:[t.jsx(l,{className:`h-5 w-5 ${s.color}`}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:`text-sm font-medium ${s.color}`,children:s.label}),t.jsx("p",{className:"text-xs text-mono-600",children:s.description})]})]},e)})}),t.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:t.jsx("button",{onClick:()=>N(!1),className:"px-3 py-2 text-sm text-mono-600 hover:text-mono-800",children:"Отмена"})})]})]}),p.vehicleIds.length>0&&t.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-4",children:"Закрепленный транспорт"}),t.jsx("div",{className:"space-y-2",children:p.vehicleIds.map((e,s)=>t.jsx("div",{className:"flex items-center justify-between p-3 bg-mono-50 rounded-lg",children:t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium text-mono-900",children:["Транспорт #",s+1]}),t.jsxs("p",{className:"text-xs text-mono-600",children:["ID: ",e]})]})},e))})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-4",children:"Быстрые действия"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>f("active"),disabled:"active"===p.status,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 text-sm font-medium text-mono-700 bg-green-50 hover:bg-mono-100 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(c,{className:"h-4 w-4"}),t.jsx("span",{children:"Отметить как доступен"})]}),t.jsxs("button",{onClick:()=>f("vacation"),disabled:"vacation"===p.status,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 text-sm font-medium text-black bg-mono-50 hover:bg-mono-100 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(d,{className:"h-4 w-4"}),t.jsx("span",{children:"Уйти в отпуск"})]}),t.jsxs("button",{onClick:()=>f("sick"),disabled:"sick"===p.status,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 text-sm font-medium text-yellow-700 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(m,{className:"h-4 w-4"}),t.jsx("span",{children:"Взять больничный"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-mono-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-4",children:"Безопасность"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Временный пароль"}),t.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:p.hasChangedPassword?"Пароль был изменен":"Рекомендуется сменить временный пароль"})]}),!p.hasChangedPassword&&t.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-primary-600 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors duration-200",children:"Сменить пароль"})]})]})]})]})})}export{h as default};
