import{u as e,a as s,j as t,U as n}from"./index-DssK2aQr.js";import{r as l,u as o}from"./vendor-CPG67Noa.js";import{f as a,a as i,c as d}from"./weighing-BTgEvgOj.js";import"./ui-DT0cN5GG.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";const r=({currentWeight:n,onWeightChange:o,isConnected:r,onConnect:c,onGetWeight:m,isLoading:x})=>{const{user:h}=e(),[u,g]=l.useState("arrival"),[b,p]=s("driverWeighingDrafts",[]),[j,f]=l.useState(null),[v,N]=l.useState(""),[w,y]=l.useState(""),[k,S]=l.useState(null),[C,W]=l.useState(null);l.useEffect(()=>{if(k){const e=setTimeout(()=>S(null),5e3);return()=>clearTimeout(e)}},[k]),l.useEffect(()=>{if(C){const e=setTimeout(()=>W(null),3e3);return()=>clearTimeout(e)}},[C]);const T={totalTrips:b.filter(e=>"completed"===e.status).length,pendingTrips:b.filter(e=>"draft"===e.status).length,totalWeight:b.filter(e=>"completed"===e.status&&e.netWeight).reduce((e,s)=>e+(s.netWeight||0),0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-mono-900 mb-2",children:"ðŸš› Ð’Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð´Ð»Ñ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÐµÐ¹"}),t.jsx("p",{className:"text-mono-600",children:"Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð²ÑŠÐµÐ·Ð´Ðµ Ð¸ Ð²Ñ‹ÐµÐ·Ð´Ðµ"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-mono-600",children:T.totalTrips}),t.jsx("div",{className:"text-sm text-mono-700",children:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾"})]}),t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-mono-600",children:T.pendingTrips}),t.jsx("div",{className:"text-sm text-yellow-700",children:"Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ"})]}),t.jsxs("div",{className:"bg-mono-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-black",children:T.totalWeight.toFixed(0)}),t.jsx("div",{className:"text-sm text-black",children:"ÐºÐ³ Ð²ÑÐµÐ³Ð¾"})]})]}),t.jsxs("div",{className:"flex space-x-1 bg-mono-100 p-1 rounded-lg",children:[t.jsx("button",{onClick:()=>g("arrival"),className:"flex-1 py-3 px-4 rounded-md font-medium transition-colors "+("arrival"===u?"bg-white text-black shadow-sm":"text-mono-600 hover:text-mono-900"),children:"ðŸš› Ð’ÑŠÐµÐ·Ð´"}),t.jsx("button",{onClick:()=>g("departure"),className:"flex-1 py-3 px-4 rounded-md font-medium transition-colors "+("departure"===u?"bg-white text-black shadow-sm":"text-mono-600 hover:text-mono-900"),children:"ðŸšš Ð’Ñ‹ÐµÐ·Ð´"})]}),t.jsxs("div",{className:"p-4 bg-mono-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-mono-700",children:"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð²ÐµÑÐ¾Ð²:"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-mono-500"}),t.jsx("span",{className:"text-sm font-medium "+(r?"text-mono-700":"text-red-700"),children:r?"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾":"ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾"})]})]}),!r&&t.jsx("button",{onClick:c,disabled:x,className:"mt-2 w-full px-4 py-2 bg-black text-white rounded-lg hover:bg-black disabled:bg-mono-400 transition-colors",children:x?"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ...":"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ðº Ð²ÐµÑÐ°Ð¼"})]}),t.jsxs("div",{className:"p-6 bg-mono-50 border border-mono-200 rounded-lg text-center",children:[t.jsx("div",{className:"text-sm text-black mb-2",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²ÐµÑ:"}),t.jsx("div",{className:"text-4xl font-bold text-black",children:n?a(n):"---"}),r&&t.jsx("button",{onClick:m,disabled:x,className:"mt-4 w-full px-6 py-3 bg-black text-white rounded-lg hover:bg-black disabled:bg-mono-400 transition-colors font-medium",children:x?"ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ...":"âš–ï¸ ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÐµÑ"})]}),"arrival"===u&&t.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-4",children:"ðŸš› Ð’ÑŠÐµÐ·Ð´ Ð½Ð° Ñ‚ÐµÑ€Ñ€Ð¸Ñ‚Ð¾Ñ€Ð¸ÑŽ"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"ÐÐ¾Ð¼ÐµÑ€ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ:"}),t.jsx("input",{type:"text",value:v,onChange:e=>N(e.target.value.toUpperCase()),placeholder:"Ð123Ð‘Ð’777",className:"w-full px-4 py-3 border border-mono-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-lg",disabled:!!j})]}),t.jsx("button",{onClick:()=>{if(!v.trim())return void S("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ");if(!n)return void S("ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ð²ÐµÑ Ð¿ÐµÑ€ÐµÐ´ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸ÐµÐ¼ Ð·Ð°Ð¿Ð¸ÑÐ¸");if(!h)return void S("ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½");if(b.find(e=>e.vehicleNumber===v.trim()&&"draft"===e.status))return void S("Ð”Ð»Ñ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð½ÐµÐ·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ");const e={id:`draft_${Date.now()}`,vehicleNumber:v.trim().toUpperCase(),grossWeight:n,grossTimestamp:(new Date).toISOString(),status:"draft",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),operatorId:h.id,operatorName:h.fullName||h.login||"Ð’Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ"};p([e,...b]),f(e),N(""),W("âœ… Ð—Ð°Ð¿Ð¸ÑÑŒ Ð²ÑŠÐµÐ·Ð´Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð°! ÐœÐ¾Ð¶ÐµÑ‚Ðµ ÐµÑ…Ð°Ñ‚ÑŒ Ð½Ð° Ñ€Ð°Ð·Ð³Ñ€ÑƒÐ·ÐºÑƒ.")},disabled:!(n&&v.trim()&&!j&&r),className:"w-full px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-mono-400 transition-colors font-medium text-lg",children:"ðŸ“ Ð—Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑŠÐµÐ·Ð´"}),j&&t.jsx("div",{className:"p-3 bg-white border border-green-300 rounded-lg",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-green-800 mb-2",children:"âœ… Ð’ÑŠÐµÐ·Ð´ Ð·Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½!"}),t.jsxs("div",{className:"text-sm text-mono-700",children:["ÐÐ¾Ð¼ÐµÑ€: ",t.jsx("span",{className:"font-bold",children:j.vehicleNumber})]}),t.jsxs("div",{className:"text-sm text-mono-700",children:["Ð’ÐµÑ: ",t.jsx("span",{className:"font-bold",children:a(j.grossWeight)})]}),t.jsxs("div",{className:"text-sm text-mono-700",children:["Ð’Ñ€ÐµÐ¼Ñ: ",t.jsx("span",{className:"font-bold",children:i(j.grossTimestamp)})]}),t.jsx("div",{className:"mt-3 text-sm text-mono-600 font-medium",children:"ÐœÐ¾Ð¶ÐµÑ‚Ðµ ÐµÑ…Ð°Ñ‚ÑŒ Ð½Ð° Ñ€Ð°Ð·Ð³Ñ€ÑƒÐ·ÐºÑƒ"})]})})]})]}),"departure"===u&&t.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-orange-900 mb-4",children:"ðŸšš Ð’Ñ‹ÐµÐ·Ð´ Ñ Ñ‚ÐµÑ€Ñ€Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-2",children:"ÐÐ¾Ð¼ÐµÑ€ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ:"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("input",{type:"text",value:w,onChange:e=>y(e.target.value.toUpperCase()),placeholder:"Ð123Ð‘Ð’777",className:"flex-1 px-4 py-3 border border-mono-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-lg"}),t.jsx("button",{onClick:()=>{if(!w.trim())return void S("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ");const e=b.find(e=>e.vehicleNumber===w.trim().toUpperCase()&&"draft"===e.status);e?(f(e),W("âœ… Ð’Ð°Ñˆ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ Ð½Ð°Ð¹Ð´ÐµÐ½! ÐœÐ¾Ð¶ÐµÑ‚Ðµ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ñ‚ÑŒÑÑ Ð½Ð° Ð²Ñ‹ÐµÐ·Ð´Ðµ.")):S("âŒ Ð—Ð°Ð¿Ð¸ÑÑŒ Ð²ÑŠÐµÐ·Ð´Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ.")},disabled:!w.trim(),className:"px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-mono-400 transition-colors font-medium",children:"ðŸ” ÐÐ°Ð¹Ñ‚Ð¸"})]})]}),j&&t.jsx("div",{className:"p-4 bg-white border border-orange-300 rounded-lg",children:t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"text-lg font-bold text-orange-800 mb-2",children:"ðŸ“‹ Ð’Ð°Ñˆ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ Ð½Ð°Ð¹Ð´ÐµÐ½"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"ÐÐ¾Ð¼ÐµÑ€:"}),t.jsx("div",{className:"font-bold text-mono-900",children:j.vehicleNumber})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’ÑŠÐµÐ·Ð´:"}),t.jsx("div",{className:"font-bold text-mono-600",children:a(j.grossWeight)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’Ñ€ÐµÐ¼Ñ Ð²ÑŠÐµÐ·Ð´Ð°:"}),t.jsx("div",{className:"text-mono-900",children:i(j.grossTimestamp)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²ÐµÑ:"}),t.jsx("div",{className:"font-bold text-black",children:n?a(n):"---"})]})]}),n&&t.jsxs("div",{className:"mt-4 p-3 bg-mono-50 border border-mono-200 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium text-black mb-2",children:"Ð Ð°ÑÑ‡ÐµÑ‚:"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’ÑŠÐµÐ·Ð´:"}),t.jsx("div",{className:"font-bold text-mono-600",children:a(j.grossWeight)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’Ñ‹ÐµÐ·Ð´:"}),t.jsx("div",{className:"font-bold text-black",children:a(n)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð“Ñ€ÑƒÐ·:"}),t.jsx("div",{className:"font-bold text-purple-600",children:a(d(j.grossWeight,n))})]})]})]}),t.jsx("button",{onClick:()=>{if(!j)return void S("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð´Ð»Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ");if(!n)return void S("ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ð²ÐµÑ Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸ÐµÐ¼");const e=d(j.grossWeight,n),s={...j,tareWeight:n,tareTimestamp:(new Date).toISOString(),netWeight:e,status:"completed",updatedAt:(new Date).toISOString()},t=b.map(e=>e.id===j.id?s:e);p(t),f(null),y(""),W("ðŸŽ‰ Ð’Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾! ÐœÐ¾Ð¶ÐµÑ‚Ðµ Ð¿Ð¾ÐºÐ¸Ð½ÑƒÑ‚ÑŒ Ñ‚ÐµÑ€Ñ€Ð¸Ñ‚Ð¾Ñ€Ð¸ÑŽ.")},disabled:!n||!r,className:"mt-4 w-full px-6 py-4 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-mono-400 transition-colors font-medium text-lg",children:"âœ… Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ"})]})})]})]}),b.length>0&&t.jsxs("div",{className:"p-4 bg-white border border-mono-200 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-mono-900 mb-4",children:"ðŸ“‹ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ð¹"}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,10).map(e=>t.jsx("div",{className:"p-3 rounded-lg border "+("completed"===e.status?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"ÐÐ¾Ð¼ÐµÑ€:"}),t.jsx("span",{className:"ml-1 font-bold",children:e.vehicleNumber})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’ÑŠÐµÐ·Ð´:"}),t.jsx("span",{className:"ml-1 font-bold text-mono-600",children:a(e.grossWeight)})]}),e.tareWeight&&t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð’Ñ‹ÐµÐ·Ð´:"}),t.jsx("span",{className:"ml-1 font-bold text-black",children:a(e.tareWeight)})]}),e.netWeight&&t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-mono-700",children:"Ð“Ñ€ÑƒÐ·:"}),t.jsx("span",{className:"ml-1 font-bold text-purple-600",children:a(e.netWeight)})]})]}),t.jsx("div",{className:"px-2 py-1 rounded text-xs font-medium "+("completed"===e.status?"bg-mono-100 text-mono-700":"bg-yellow-100 text-yellow-700"),children:"completed"===e.status?"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾":"Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ"})]})},e.id))})]}),k&&t.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsx("div",{className:"flex items-center",children:t.jsx("span",{className:"text-mono-600 font-medium",children:k})})}),C&&t.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:t.jsx("div",{className:"flex items-center",children:t.jsx("span",{className:"text-mono-600 font-medium",children:C})})})]})},c=()=>{const s=o(),{user:a}=e(),[i,d]=l.useState("https://your-cloud-server.com:3001"),[c,m]=l.useState("cloud"),[x,h]=l.useState(!1),[u,g]=l.useState(null),[b,p]=l.useState(!1),[j,f]=l.useState(null),[v,N]=l.useState([]),[w,y]=l.useState(""),[k,S]=l.useState(""),[C,W]=l.useState(""),[T,$]=l.useState(""),[E,D]=l.useState("checking"),[I,F]=l.useState("simple");l.useEffect(()=>{const e=()=>{navigator.onLine?fetch("http://192.168.1.100:8080/status",{method:"HEAD",mode:"no-cors"}).then(()=>{D("wifi"),m("local"),d("http://192.168.1.100:8080")}).catch(()=>{D("mobile"),m("cloud"),d("https://your-cloud-server.com:3001")}):D("offline")};e();const s=setInterval(e,3e4);return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{clearInterval(s),window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),l.useEffect(()=>{a&&a.role!==n.DRIVER&&s("/dashboard")},[a,s]);const O=async()=>{p(!0),f(null);try{const e="cloud"===c?"/cloud/status":"/status",s=await fetch(`${i}${e}`);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);{const e=await s.json();h(e.scales_connected||"online"===e.local_server_status),null!==e.last_weight&&g(e.last_weight)}}catch(e){f(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ: ${e instanceof Error?e.message:"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°"}`),h(!1)}finally{p(!1)}},L=async()=>{if(x){p(!0);try{const e="cloud"===c?"/cloud/weight":"/weight",s=await fetch(`${i}${e}`);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);{const e=await s.json();g(e.value),f(null)}}catch(e){f(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð²ÐµÑÐ°: ${e instanceof Error?e.message:"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°"}`)}finally{p(!1)}}else f("ÐÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Ð²ÐµÑÐ°Ð¼")};return l.useEffect(()=>{const e=localStorage.getItem("driverWeighingHistory");if(e)try{const s=JSON.parse(e);N(s.map(e=>({...e,timestamp:new Date(e.timestamp)})))}catch(s){}},[]),t.jsx("div",{className:"min-h-screen bg-mono-50 p-4",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("button",{onClick:()=>s("/dashboard"),className:"mb-4 inline-flex items-center px-4 py-2 bg-mono-600 text-white rounded-lg hover:bg-mono-700 transition-colors",children:"â† ÐÐ°Ð·Ð°Ð´ Ðº Dashboard"}),t.jsx("h1",{className:"text-3xl font-bold text-mono-900 mb-2",children:"âš–ï¸ Ð’Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð´Ð»Ñ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÐµÐ¹"}),t.jsx("p",{className:"text-mono-600 mb-4",children:"Ð¡Ð°Ð¼Ð¾ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð² Ð² Ð½Ð¾Ñ‡Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ"}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex space-x-1 bg-mono-100 p-1 rounded-lg w-fit",children:[t.jsx("button",{onClick:()=>F("simple"),className:"px-4 py-2 rounded-md font-medium transition-colors "+("simple"===I?"bg-white text-black shadow-sm":"text-mono-600 hover:text-mono-900"),children:"ðŸš› ÐŸÑ€Ð¾ÑÑ‚Ð¾Ðµ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ"}),t.jsx("button",{onClick:()=>F("advanced"),className:"px-4 py-2 rounded-md font-medium transition-colors "+("advanced"===I?"bg-white text-black shadow-sm":"text-mono-600 hover:text-mono-900"),children:"ðŸ“‹ ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸"})]})}),t.jsxs("div",{className:"mb-4 p-3 rounded-lg border",children:["checking"===E&&t.jsxs("div",{className:"flex items-center space-x-2 text-mono-600",children:[t.jsx("div",{className:"w-3 h-3 bg-mono-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-sm",children:"ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ..."})]}),"wifi"===E&&t.jsxs("div",{className:"flex items-center space-x-2 text-mono-600",children:[t.jsx("div",{className:"w-3 h-3 bg-mono-500 rounded-full"}),t.jsx("span",{className:"text-sm",children:"âœ… Wi-Fi Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾"})]}),"mobile"===E&&t.jsxs("div",{className:"flex items-center space-x-2 text-mono-600",children:[t.jsx("div",{className:"w-3 h-3 bg-mono-500 rounded-full"}),t.jsx("span",{className:"text-sm",children:"âš ï¸ ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ"})]}),"offline"===E&&t.jsxs("div",{className:"flex items-center space-x-2 text-mono-600",children:[t.jsx("div",{className:"w-3 h-3 bg-mono-500 rounded-full"}),t.jsx("span",{className:"text-sm",children:"âŒ ÐÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚Ñƒ"})]}),"mobile"===E&&"cloud"===c&&t.jsxs("div",{className:"mt-2 p-2 bg-mono-50 border border-mono-200 rounded text-xs text-mono-600",children:[t.jsx("strong",{children:"Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð¯:"})," Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¾Ð±Ð»Ð°Ñ‡Ð½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚. Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½Ð½Ñ‹Ð¹ ÑÐµÑ€Ð²ÐµÑ€."]})]})]}),"simple"===I?t.jsx(r,{currentWeight:u,onWeightChange:g,isConnected:x,onConnect:O,onGetWeight:L,isLoading:b}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-12 h-12 bg-black rounded-lg flex items-center justify-center text-white text-xl",children:"âš–ï¸"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-mono-900",children:"Ð’ÐµÑÑ‹ ÑÐºÐ»Ð°Ð´Ð°"}),t.jsx("p",{className:"text-mono-600",children:"ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ Ð²ÐµÑÐ¾Ð²"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full "+(x?"bg-mono-500":"bg-mono-700")}),t.jsx("span",{className:"text-sm font-medium "+(x?"text-mono-600":"text-mono-700"),children:x?"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾":"ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾"})]})]}),t.jsxs("div",{className:"mb-6 p-4 bg-mono-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700",children:"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð²ÐµÑÐ°Ð¼:"}),t.jsx("div",{className:"flex items-center space-x-2",children:t.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("local"===c?"bg-mono-100 text-mono-700":"bg-mono-200 text-mono-800"),children:"local"===c?"Wi-Fi (Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ)":"ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾Ðµ (Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚)"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("input",{type:"text",value:i,onChange:e=>d(e.target.value),className:"flex-1 px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-mono-500",placeholder:"local"===c?"http://192.168.1.100:8080":"https://your-cloud-server.com:3001"}),t.jsx("button",{onClick:O,disabled:b,className:"px-4 py-2 bg-black text-white rounded-lg hover:bg-mono-800 disabled:bg-mono-400 transition-colors",children:b?"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ...":"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ"})]}),t.jsx("div",{className:"text-xs text-mono-500",children:"local"===c?t.jsx(t.Fragment,{children:"Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Wi-Fi ÑÐµÑ‚ÑŒ ÑÐºÐ»Ð°Ð´Ð°"}):t.jsx(t.Fragment,{children:"ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚"})})]})]}),t.jsxs("div",{className:"mb-6 p-6 bg-mono-50 border border-mono-200 rounded-lg text-center",children:[t.jsx("div",{className:"text-sm text-black mb-2",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²ÐµÑ:"}),t.jsx("div",{className:"text-4xl font-bold text-black",children:null!==u?`${u.toFixed(2)} ÐºÐ³`:"---"})]}),t.jsxs("div",{className:"flex space-x-3 mb-6",children:[t.jsxs("button",{onClick:L,disabled:!x||b,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-mono-400 transition-colors",children:[t.jsx("span",{children:"âš–ï¸"}),t.jsx("span",{children:"ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÐµÑ"})]}),t.jsxs("button",{onClick:async()=>{if(x)try{const e="cloud"===c?"/cloud/tare":"/tare",s=await fetch(`${i}${e}`,{method:"POST"});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);g(0),f(null)}catch(e){f(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½ÑƒÐ»ÐµÐ½Ð¸Ñ: ${e instanceof Error?e.message:"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°"}`)}else f("ÐÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Ð²ÐµÑÐ°Ð¼")},disabled:!x||b,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-mono-400 transition-colors",children:[t.jsx("span",{children:"ðŸ”„"}),t.jsx("span",{children:"ÐžÐ±Ð½ÑƒÐ»Ð¸Ñ‚ÑŒ"})]})]}),j&&t.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center space-x-2 text-mono-600",children:[t.jsx("span",{children:"âš ï¸"}),t.jsx("span",{className:"text-sm",children:j})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[t.jsx("h3",{className:"text-lg font-bold text-mono-900 mb-4",children:"ðŸ“ Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Ð˜Ð¼Ñ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»Ñ *"}),t.jsx("input",{type:"text",value:w,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-mono-500",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÐµ Ð¸Ð¼Ñ"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"ÐÐ¾Ð¼ÐµÑ€ Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð° *"}),t.jsx("input",{type:"text",value:k,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-mono-500",placeholder:"Ð123Ð‘Ð’ 777"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Ð¢Ð¸Ð¿ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð° *"}),t.jsxs("select",{value:C,onChange:e=>W(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-mono-500",children:[t.jsx("option",{value:"",children:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»"}),t.jsx("option",{value:"Ð¿ÐµÑÐ¾Ðº",children:"ÐŸÐµÑÐ¾Ðº"}),t.jsx("option",{value:"Ñ‰ÐµÐ±ÐµÐ½ÑŒ",children:"Ð©ÐµÐ±ÐµÐ½ÑŒ"}),t.jsx("option",{value:"Ñ†ÐµÐ¼ÐµÐ½Ñ‚",children:"Ð¦ÐµÐ¼ÐµÐ½Ñ‚"}),t.jsx("option",{value:"Ð±ÐµÑ‚Ð¾Ð½",children:"Ð‘ÐµÑ‚Ð¾Ð½"}),t.jsx("option",{value:"Ð´Ñ€ÑƒÐ³Ð¾Ðµ",children:"Ð”Ñ€ÑƒÐ³Ð¾Ðµ"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ"}),t.jsx("input",{type:"text",value:T,onChange:e=>$(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-mono-500",placeholder:"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ"})]})]}),t.jsx("button",{onClick:()=>{if(!(u&&w&&k&&C))return void f("Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ");const e={id:Date.now().toString(),timestamp:new Date,weight:u,driver:w,vehicle:k,material:C,notes:T||void 0};N(s=>[e,...s]);const s=JSON.parse(localStorage.getItem("driverWeighingHistory")||"[]");s.unshift(e),localStorage.setItem("driverWeighingHistory",JSON.stringify(s)),y(""),S(""),W(""),$(""),alert(`âœ… Ð’Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾!\nÐ’ÐµÑ: ${u} ÐºÐ³\nÐ’Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ: ${w}\nÐ¢Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚: ${k}\nÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»: ${C}`)},disabled:!(u&&w&&k&&C),className:"w-full px-4 py-3 bg-black text-white rounded-lg hover:bg-black disabled:bg-mono-400 transition-colors",children:"ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ"})]}),v.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsx("h3",{className:"text-lg font-bold text-mono-900 mb-4",children:"ðŸ“‹ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ð·Ð²ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ð¹"}),t.jsx("div",{className:"space-y-3",children:v.slice(0,5).map(e=>t.jsxs("div",{className:"p-3 bg-mono-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-mono-900",children:[e.weight.toFixed(2)," ÐºÐ³ - ",e.material]}),t.jsxs("div",{className:"text-sm text-mono-600",children:[e.driver," â€¢ ",e.vehicle]}),t.jsx("div",{className:"text-xs text-mono-500",children:e.timestamp.toLocaleString("ru-RU")})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"text-sm font-medium text-black",children:["#",e.id.slice(-6)]})})]}),e.notes&&t.jsxs("div",{className:"mt-2 text-sm text-mono-600 italic",children:['"',e.notes,'"']})]},e.id))})]})]})]})})};export{c as default};
