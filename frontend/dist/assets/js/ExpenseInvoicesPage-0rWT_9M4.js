import{u as e,a as t,j as s,P as o}from"./index-DssK2aQr.js";import{r as l}from"./vendor-CPG67Noa.js";import{V as r}from"./ViewToggle-BZCXPk9z.js";import{N as a,Z as n,P as i,Q as d,i as m,b as c,T as x,G as u,x as h,F as p,g as b,O as v,Y as j,a as g,V as N,ac as f,ae as y,D as w,af as C,ag as k,ah as I,ai as S}from"./ui-DT0cN5GG.js";import{E as D}from"./ExpenseInvoicePrint-CKFMj2Ic.js";import"./utils-CHM7ATol.js";import"./forms-BH-hazHY.js";const A="Без договора",O=[],F=[],$=[],M=[],P=[],_=[];function q({invoice:o,onSave:r,isEditing:p=!1}){const{user:b}=e(),[v]=t("counterparties",F);t("materials",P);const[j]=t("concreteGrades",O),[g]=t("drivers",$),[N]=t("vehicles",M),[f]=t("warehouses",_),[y]=t("orders",[]),w="accountant"===b?.role||"director"===b?.role,C=()=>{const e=new Date;return`РН-${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}-${Math.floor(1e3*Math.random()).toString().padStart(3,"0")}`},[k,I]=l.useState(""),[S,D]=l.useState({invoiceNumber:C(),invoiceDate:(new Date).toISOString().split("T")[0],supplier:"",customerId:"",customerName:"",contract:A,seal:"",warehouseId:"",warehouseName:"",items:[{id:"1",number:1,productCode:"",productName:"",quantity:0,price:w?0:void 0,amount:w?0:void 0}],delivery:{deliveryObject:"",deliveryAddress:"",dispatcher:b?.fullName||b?.login||"",driverId:"",driverName:"",vehicleId:"",vehicleNumber:"",netWeight:void 0,grossWeight:void 0,coneSlump:void 0,dailyVolume:void 0},timing:{departureFromPlant:"",arrivalAtObject:"",departureFromObject:"",arrivalAtPlant:""},total:w?0:void 0,vatAmount:w?0:void 0,releasedBy:b?.fullName||b?.login||"",receivedBy:""}),[q,L]=l.useState({});l.useEffect(()=>{D(o?{invoiceNumber:o.invoiceNumber,invoiceDate:o.invoiceDate,supplier:o.supplier,customerId:o.customerId,customerName:o.customerName,contract:o.contract,seal:o.seal,warehouseId:o.warehouseId,warehouseName:o.warehouseName,items:o.items,delivery:o.delivery,timing:o.timing,total:o.total,vatAmount:o.vatAmount,releasedBy:o.releasedBy,receivedBy:o.receivedBy}:e=>({...e,invoiceNumber:C()}))},[o,b]);const B=(e,t)=>{D(s=>({...s,[e]:t}))},z=(e,t,s)=>{D(o=>({...o,items:o.items.map(o=>{if(o.id===e){const e={...o,[t]:s};if("productName"===t){const t=j.find(e=>e.name===s);t&&(e.cementConsumption=t.cementConsumption,e.gravelConsumption=t.gravelConsumption,e.sandConsumption=t.sandConsumption,e.plasticizerConsumption=t.plasticizerConsumption)}return"quantity"!==t&&"price"!==t||w&&e.quantity&&e.price&&(e.amount=e.quantity*e.price),e}return o})})),!w||"quantity"!==t&&"price"!==t||V()},V=()=>{const e=S.items.reduce((e,t)=>e+(t.amount||0),0);D(t=>({...t,total:e,vatAmount:.12*e}))},T=(e,t)=>{D(s=>({...s,delivery:{...s.delivery,[e]:t}}))},W=(e,t)=>{D(s=>({...s,timing:{...s.timing,[e]:t}}))};return s.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-lg shadow-lg",children:[s.jsxs("div",{className:"p-6 border-b border-mono-200",children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsx("h2",{className:"text-2xl font-bold text-mono-900",children:p?"Редактировать расходную накладную":"Создать расходную накладную"})}),!p&&s.jsxs("div",{className:"bg-mono-50 border border-mono-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-black mb-3",children:"Импорт данных из заказа"}),s.jsxs("div",{className:"mb-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-sm",children:[s.jsx("p",{children:s.jsx("strong",{children:"Отладка:"})}),s.jsxs("p",{children:["Всего заказов: ",y.length]}),s.jsxs("p",{children:["Подходящие заказы: ",y.filter(e=>"confirmed"===e.status||"in_production"===e.status).length]}),s.jsxs("p",{children:["Статусы заказов: ",y.map(e=>e.status).join(", ")]})]}),s.jsxs("div",{className:"flex gap-4 items-end",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-black mb-1",children:"Выберите заказ для автоматического заполнения"}),s.jsxs("select",{value:k,onChange:e=>{I(e.target.value),e.target.value&&(e=>{const t=y.find(t=>t.id===e);if(!t)return;const s=j.find(e=>e.id===t.concreteGradeId);D(e=>({...e,customerId:t.customerId,customerName:t.customerName,warehouseId:t.warehouseId,warehouseName:t.warehouseName,orderId:t.id,items:[{id:"1",number:1,productCode:s?.code||"",productName:t.concreteGradeName,quantity:t.quantity,price:w?t.price||0:void 0,amount:w?t.totalPrice||0:void 0,cementConsumption:s?.cementConsumption||0,gravelConsumption:s?.gravelConsumption||0,sandConsumption:s?.sandConsumption||0,plasticizerConsumption:s?.plasticizerConsumption||0}],delivery:{...e.delivery,deliveryObject:t.deliveryObject,deliveryAddress:t.deliveryAddress}})),I(e)})(e.target.value)},className:"w-full px-3 py-2 border border-blue-300 rounded-md bg-white",children:[s.jsx("option",{value:"",children:"-- Выберите заказ --"}),y.filter(e=>"confirmed"===e.status||"in_production"===e.status).map(e=>s.jsxs("option",{value:e.id,children:[e.customerName," - ",e.concreteGradeName," (",e.quantity,"м³) - ",e.deliveryObject]},e.id))]})]}),k&&s.jsx("button",{type:"button",onClick:()=>{I(""),D({invoiceNumber:C(),invoiceDate:(new Date).toISOString().split("T")[0],supplier:"",customerId:"",customerName:"",contract:A,seal:"",warehouseId:"",warehouseName:"",items:[{id:"1",number:1,productCode:"",productName:"",quantity:0,price:w?0:void 0,amount:w?0:void 0}],delivery:{deliveryObject:"",deliveryAddress:"",dispatcher:b?.fullName||b?.login||"",driverId:"",driverName:"",vehicleId:"",vehicleNumber:"",netWeight:void 0,grossWeight:void 0,coneSlump:void 0,dailyVolume:void 0},timing:{departureFromPlant:"",arrivalAtObject:"",departureFromObject:"",arrivalAtPlant:""},releasedBy:b?.fullName||b?.login||"",receivedBy:""})},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Очистить"})]}),k&&s.jsx("p",{className:"text-sm text-black mt-2",children:"✅ Данные заказа импортированы. Проверьте и при необходимости отредактируйте поля."})]})]}),s.jsxs("form",{onSubmit:e=>{e.preventDefault();const t={};if(S.supplier.trim()||(t.supplier="Выберите поставщика"),S.customerId||(t.customerId="Выберите покупателя"),S.warehouseId||(t.warehouseId="Выберите склад"),S.delivery.driverId||(t.driverId="Выберите водителя"),S.delivery.vehicleId||(t.vehicleId="Выберите автомобиль"),S.seal.trim()||(t.seal="Укажите пломбу"),S.items.forEach((e,s)=>{e.productName.trim()||(t[`item_${s}_name`]="Укажите наименование товара"),(!e.quantity||e.quantity<=0)&&(t[`item_${s}_quantity`]="Укажите количество")}),L(t),0===Object.keys(t).length&&(r(S),S.orderId)){(e=>{if(!S.orderId)return;const t=y.map(t=>t.id===S.orderId?{...t,assignedDriverId:S.delivery.driverId,assignedDriverName:S.delivery.driverName,assignedVehicleId:S.delivery.vehicleId,assignedVehicleNumber:S.delivery.vehicleNumber,departureTime:S.timing.departureFromPlant,expenseInvoiceId:e,status:"in_production",updatedAt:(new Date).toISOString()}:t);localStorage.setItem("orders",JSON.stringify(t))})(`invoice_${Date.now()}`)}},className:"p-6 space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Номер накладной"}),s.jsx("input",{type:"text",value:S.invoiceNumber,className:"w-full px-3 py-2 border border-mono-300 rounded-md bg-mono-50",readOnly:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Дата накладной"}),s.jsxs("div",{className:"relative",children:[s.jsx(a,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"date",value:S.invoiceDate,onChange:e=>B("invoiceDate",e.target.value),className:"pl-10 w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Поставщик *"}),s.jsxs("div",{className:"relative",children:[s.jsx(n,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{value:S.supplier,onChange:e=>B("supplier",e.target.value),className:`pl-10 w-full px-3 py-2 border ${q.supplier?"border-red-500":"border-mono-300"} rounded-md`,children:[s.jsx("option",{value:"",children:"Выберите поставщика"}),v.filter(e=>"supplier"===e.type&&e.isActive).map(e=>s.jsx("option",{value:e.name,children:e.name},e.id))]}),q.supplier&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.supplier})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Покупатель *"}),s.jsxs("div",{className:"relative",children:[s.jsx(n,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{value:S.customerId,onChange:e=>{const t=v.find(t=>t.id===e.target.value);B("customerId",e.target.value),B("customerName",t?.name||"")},className:`pl-10 w-full px-3 py-2 border ${q.customerId?"border-red-500":"border-mono-300"} rounded-md`,children:[s.jsx("option",{value:"",children:"Выберите покупателя"}),v.filter(e=>e.isActive).map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),q.customerId&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.customerId})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Договор"}),s.jsx("input",{type:"text",value:S.contract,onChange:e=>B("contract",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Пломба *"}),s.jsx("input",{type:"text",value:S.seal,onChange:e=>B("seal",e.target.value),className:`w-full px-3 py-2 border ${q.seal?"border-red-500":"border-mono-300"} rounded-md`,placeholder:"Введите номер пломбы"}),q.seal&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.seal})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Склад *"}),s.jsxs("div",{className:"relative",children:[s.jsx(i,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{value:S.warehouseId,onChange:e=>{const t=f.find(t=>t.id===e.target.value);B("warehouseId",e.target.value),B("warehouseName",t?.name||"")},className:`pl-10 w-full px-3 py-2 border ${q.warehouseId?"border-red-500":"border-mono-300"} rounded-md`,children:[s.jsx("option",{value:"",children:"Выберите склад"}),f.filter(e=>e.isActive).map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),q.warehouseId&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.warehouseId})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900",children:"Товары"}),s.jsxs("button",{type:"button",onClick:()=>{const e={id:Date.now().toString(),number:S.items.length+1,productCode:"",productName:"",quantity:0,price:w?0:void 0,amount:w?0:void 0,cementConsumption:0,gravelConsumption:0,sandConsumption:0,plasticizerConsumption:0};D(t=>({...t,items:[...t.items,e]}))},className:"flex items-center px-3 py-2 bg-black text-white rounded-md hover:bg-black",children:[s.jsx(d,{className:"h-4 w-4 mr-2"}),"Добавить товар"]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full border border-mono-300",children:[s.jsx("thead",{className:"bg-mono-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"№"}),s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Код марки"}),s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Марка бетона"}),s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Количество"}),w&&s.jsxs(s.Fragment,{children:[s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Цена"}),s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Сумма"})]}),s.jsx("th",{className:"border border-mono-300 px-4 py-2 text-left text-sm font-medium text-mono-900",children:"Действия"})]})}),s.jsx("tbody",{children:S.items.map((e,t)=>s.jsxs("tr",{children:[s.jsx("td",{className:"border border-mono-300 px-4 py-2",children:s.jsx("input",{type:"text",value:e.number,className:"w-full text-center bg-mono-50 border-0",readOnly:!0})}),s.jsx("td",{className:"border border-mono-300 px-4 py-2",children:s.jsx("input",{type:"text",value:e.productCode,onChange:t=>z(e.id,"productCode",t.target.value),className:"w-full border-0 focus:ring-0",placeholder:"Код марки"})}),s.jsxs("td",{className:"border border-mono-300 px-4 py-2",children:[s.jsxs("select",{value:e.productName,onChange:t=>z(e.id,"productName",t.target.value),className:"w-full border-0 focus:ring-0 "+(q[`item_${t}_name`]?"bg-red-50":""),children:[s.jsx("option",{value:"",children:"Выберите марку бетона"}),j.filter(e=>e.isActive).map(e=>s.jsx("option",{value:e.name,children:e.name},e.id))]}),q[`item_${t}_name`]&&s.jsx("p",{className:"text-xs text-mono-600",children:q[`item_${t}_name`]})]}),s.jsxs("td",{className:"border border-mono-300 px-4 py-2",children:[s.jsx("input",{type:"number",step:"0.001",value:e.quantity,onChange:t=>z(e.id,"quantity",parseFloat(t.target.value)||0),className:"w-full border-0 focus:ring-0 "+(q[`item_${t}_quantity`]?"bg-red-50":""),placeholder:"0,000"}),q[`item_${t}_quantity`]&&s.jsx("p",{className:"text-xs text-mono-600",children:q[`item_${t}_quantity`]})]}),w&&s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"border border-mono-300 px-4 py-2",children:s.jsx("input",{type:"number",step:"0.01",value:e.price||"",onChange:t=>z(e.id,"price",parseFloat(t.target.value)||0),className:"w-full border-0 focus:ring-0",placeholder:"0.00"})}),s.jsx("td",{className:"border border-mono-300 px-4 py-2",children:s.jsx("input",{type:"number",step:"0.01",value:e.amount||"",className:"w-full border-0 bg-mono-50",readOnly:!0})})]}),s.jsx("td",{className:"border border-mono-300 px-4 py-2",children:s.jsx("button",{type:"button",onClick:()=>{return t=e.id,void(S.items.length<=1||D(e=>({...e,items:e.items.filter(e=>e.id!==t).map((e,t)=>({...e,number:t+1}))})));var t},disabled:S.items.length<=1,className:"text-mono-600 hover:text-red-800 disabled:text-mono-400",children:s.jsx(m,{className:"h-4 w-4"})})})]},e.id))})]})})]}),s.jsxs("div",{className:"bg-mono-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Расходы материалов (внутренний учет)"}),s.jsx("div",{className:"space-y-4",children:S.items.map((e,t)=>s.jsxs("div",{className:"bg-white p-4 rounded border",children:[s.jsx("h4",{className:"font-medium text-sm text-mono-700 mb-3",children:e.productName||"Марка бетона"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-mono-600 mb-1",children:"Цемент (кг/м³)"}),s.jsx("input",{type:"number",value:e.cementConsumption||"",onChange:t=>z(e.id,"cementConsumption",parseFloat(t.target.value)||0),className:"w-full px-3 py-2 text-sm border border-mono-300 rounded focus:ring-1 focus:ring-mono-500 focus:border-mono-500",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-mono-600 mb-1",children:"Щебень (кг/м³)"}),s.jsx("input",{type:"number",value:e.gravelConsumption||"",onChange:t=>z(e.id,"gravelConsumption",parseFloat(t.target.value)||0),className:"w-full px-3 py-2 text-sm border border-mono-300 rounded focus:ring-1 focus:ring-mono-500 focus:border-mono-500",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-mono-600 mb-1",children:"Песок (кг/м³)"}),s.jsx("input",{type:"number",value:e.sandConsumption||"",onChange:t=>z(e.id,"sandConsumption",parseFloat(t.target.value)||0),className:"w-full px-3 py-2 text-sm border border-mono-300 rounded focus:ring-1 focus:ring-mono-500 focus:border-mono-500",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-mono-600 mb-1",children:"Пластификатор (л/м³)"}),s.jsx("input",{type:"number",step:"0.1",value:e.plasticizerConsumption||"",onChange:t=>z(e.id,"plasticizerConsumption",parseFloat(t.target.value)||0),className:"w-full px-3 py-2 text-sm border border-mono-300 rounded focus:ring-1 focus:ring-mono-500 focus:border-mono-500",placeholder:"0"})]})]})]},e.id))}),s.jsx("p",{className:"text-xs text-black mt-3",children:"* Эти поля автоматически заполняются при выборе марки бетона и используются для внутреннего учета запасов"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900",children:"Доставка"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Объект доставки"}),s.jsx("input",{type:"text",value:S.delivery.deliveryObject,onChange:e=>T("deliveryObject",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md",placeholder:"Название объекта"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Адрес доставки (из 2ГИС) *"}),s.jsx("textarea",{value:S.delivery.deliveryAddress,onChange:e=>T("deliveryAddress",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md resize-none",placeholder:"Скопируйте адрес из 2ГИС для навигации водителя",rows:3}),s.jsx("p",{className:"text-xs text-mono-500 mt-1",children:"Водитель сможет нажать на этот адрес для навигации"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Диспетчер"}),s.jsx("input",{type:"text",value:S.delivery.dispatcher,className:"w-full px-3 py-2 border border-mono-300 rounded-md bg-mono-50",readOnly:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Водитель *"}),s.jsxs("div",{className:"relative",children:[s.jsx(c,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{value:S.delivery.driverId,onChange:e=>{const t=g.find(t=>t.id===e.target.value);T("driverId",e.target.value),T("driverName",t?.fullName||"")},className:`pl-10 w-full px-3 py-2 border ${q.driverId?"border-red-500":"border-mono-300"} rounded-md`,children:[s.jsx("option",{value:"",children:"Выберите водителя"}),g.filter(e=>e.isActive).map(e=>s.jsx("option",{value:e.id,children:e.fullName},e.id))]}),q.driverId&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.driverId})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Номер автомобиля *"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsxs("select",{value:S.delivery.vehicleId,onChange:e=>{const t=N.find(t=>t.id===e.target.value);T("vehicleId",e.target.value),T("vehicleNumber",t?.licensePlate||"")},className:`pl-10 w-full px-3 py-2 border ${q.vehicleId?"border-red-500":"border-mono-300"} rounded-md`,children:[s.jsx("option",{value:"",children:"Выберите автомобиль"}),N.filter(e=>e.isActive).map(e=>s.jsx("option",{value:e.id,children:e.licensePlate},e.id))]}),q.vehicleId&&s.jsx("p",{className:"mt-1 text-sm text-mono-600",children:q.vehicleId})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Вес нетто (т)"}),s.jsx("input",{type:"number",step:"0.01",value:S.delivery.netWeight||"",onChange:e=>T("netWeight",parseFloat(e.target.value)||void 0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Вес брутто (т)"}),s.jsx("input",{type:"number",step:"0.01",value:S.delivery.grossWeight||"",onChange:e=>T("grossWeight",parseFloat(e.target.value)||void 0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Осадка конуса"}),s.jsx("input",{type:"number",step:"0.1",value:S.delivery.coneSlump||"",onChange:e=>T("coneSlump",parseFloat(e.target.value)||void 0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Объём с нач. дня (м³)"}),s.jsx("input",{type:"number",step:"0.1",value:S.delivery.dailyVolume||"",onChange:e=>T("dailyVolume",parseFloat(e.target.value)||void 0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900",children:"Время движения автомобиля"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Время убытия с завода"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"time",value:S.timing.departureFromPlant,onChange:e=>W("departureFromPlant",e.target.value),className:"pl-10 w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Время прибытия на объект"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"time",value:S.timing.arrivalAtObject,onChange:e=>W("arrivalAtObject",e.target.value),className:"pl-10 w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Время убытия с объекта"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"time",value:S.timing.departureFromObject,onChange:e=>W("departureFromObject",e.target.value),className:"pl-10 w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Время прибытия на завод"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"time",value:S.timing.arrivalAtPlant,onChange:e=>W("arrivalAtPlant",e.target.value),className:"pl-10 w-full px-3 py-2 border border-mono-300 rounded-md"})]})]})]})]}),w&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 bg-mono-50 p-4 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Итого"}),s.jsx("input",{type:"number",step:"0.01",value:S.total||"",onChange:e=>B("total",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"В том числе НДС"}),s.jsx("input",{type:"number",step:"0.01",value:S.vatAmount||"",onChange:e=>B("vatAmount",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Выпустил"}),s.jsx("input",{type:"text",value:S.releasedBy,onChange:e=>B("releasedBy",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Получено"}),s.jsx("input",{type:"text",value:S.receivedBy,onChange:e=>B("receivedBy",e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md",placeholder:"Подпись получателя"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-mono-200",children:[s.jsx("button",{type:"button",className:"px-6 py-2 border border-mono-300 rounded-md text-mono-700 hover:bg-mono-50",children:"Отмена"}),s.jsxs("button",{type:"submit",className:"flex items-center px-6 py-2 bg-black text-white rounded-md hover:bg-black",children:[s.jsx(h,{className:"h-4 w-4 mr-2"}),p?"Обновить":"Создать"]})]})]})]})}const L=[];function B(){const{user:a}=e(),i=()=>{const e=(new Date).toISOString().slice(0,10).replace(/-/g,""),t=u.filter(t=>t.invoiceNumber.startsWith(`РН-${e}`)).length+1;return`РН-${e}-${t.toString().padStart(3,"0")}`},[u,h]=t("expenseInvoices",L),[A,O]=t("invoicesViewMode","list"),[F,$]=l.useState(!1),[M,P]=l.useState(null),[_,B]=l.useState(!1),[z,V]=l.useState(null),[T,W]=l.useState(""),[E,G]=l.useState(""),[Z,K]=l.useState(""),[Y,J]=l.useState(""),[Q,H]=l.useState(""),[R,U]=l.useState(!1),[X,ee]=l.useState("invoiceDate"),[te,se]=l.useState("desc"),[oe,le]=l.useState(1),[re,ae]=l.useState(10),[ne,ie]=l.useState([]),de=l.useMemo(()=>Array.from(new Set(u.map(e=>e.supplier))).sort(),[u]),me=l.useMemo(()=>Array.from(new Set(u.map(e=>e.customerName))).sort(),[u]),ce=l.useMemo(()=>{let e=u.filter(e=>!!(!T||e.invoiceNumber.toLowerCase().includes(T.toLowerCase())||e.customerName.toLowerCase().includes(T.toLowerCase())||e.delivery.deliveryObject.toLowerCase().includes(T.toLowerCase())||e.supplier.toLowerCase().includes(T.toLowerCase()))&&((!E||e.supplier===E)&&((!Z||e.customerName===Z)&&(!(Y&&e.invoiceDate<Y)&&!(Q&&e.invoiceDate>Q)))));return e.sort((e,t)=>{let s=e[X],o=t[X];return"invoiceDate"===X?(s=new Date(e.invoiceDate).getTime(),o=new Date(t.invoiceDate).getTime()):"total"===X?(s=e.total||0,o=t.total||0):(s=String(s).toLowerCase(),o=String(o).toLowerCase()),"asc"===te?s<o?-1:s>o?1:0:s>o?-1:s<o?1:0}),e},[u,T,E,Z,Y,Q,X,te]),xe=l.useMemo(()=>{const e=(oe-1)*re,t=e+re;return ce.slice(e,t)},[ce,oe,re]),ue=Math.ceil(ce.length/re),he=e=>{X===e?se("asc"===te?"desc":"asc"):(ee(e),se("asc"))},pe=e=>{const t={...e,id:Date.now().toString(),invoiceNumber:i(),invoiceDate:(new Date).toISOString().split("T")[0],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),receivedBy:""};h(e=>[t,...e])},be=e=>X!==e?null:"asc"===te?s.jsx(I,{className:"h-4 w-4"}):s.jsx(S,{className:"h-4 w-4"});if("dispatcher"!==a?.role)return s.jsx(o,{title:"Расходные накладные",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx(p,{className:"h-16 w-16 text-mono-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-mono-900 mb-2",children:"Доступ запрещён"}),s.jsx("p",{className:"text-mono-500",children:"Эта функция доступна только диспетчерам"})]})})});u.filter(e=>e.invoiceNumber.toLowerCase().includes(T.toLowerCase())||e.customerName.toLowerCase().includes(T.toLowerCase())||e.delivery.deliveryObject.toLowerCase().includes(T.toLowerCase()));const ve=()=>{P(null),$(!0)},je=e=>{P(e),$(!0)},ge=e=>{window.confirm("Вы уверены, что хотите удалить эту накладную?")&&h(t=>t.filter(t=>t.id!==e))},Ne=e=>{V(e),B(!0)},fe=e=>{V(e),B(!0),setTimeout(()=>{window.print()},500)},ye=async e=>{alert("Функция экспорта в PDF будет реализована в следующей версии")},we=e=>{if(M)h(t=>t.map(t=>t.id===M.id?{...t,...e,updatedAt:(new Date).toISOString()}:t));else{const t={...e,id:Date.now().toString(),invoiceNumber:i(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),createdBy:a?.id||"",createdByName:a?.fullName||a?.login||"",isActive:!0};h(e=>[t,...e])}$(!1),P(null)},Ce=e=>new Date(e).toLocaleDateString("kk-KZ"),ke=e=>new Intl.NumberFormat("kk-KZ",{style:"currency",currency:"KZT",minimumFractionDigits:0}).format(e);return F?s.jsxs(o,{title:M?"Редактировать накладную":"Создать накладную",children:[s.jsx(q,{invoice:M,onSave:we,isEditing:!!M}),s.jsx("div",{className:"mt-6 p-4 bg-mono-50 border-t border-mono-200 text-center",children:s.jsxs("button",{onClick:()=>{$(!1),P(null)},className:"flex items-center mx-auto px-6 py-3 bg-black text-white rounded-lg hover:bg-black transition-colors",children:[s.jsx(b,{className:"h-4 w-4 mr-2"}),"Назад к списку"]})})]}):_&&z?s.jsxs("div",{className:"print-container",children:[s.jsx(D,{invoice:z}),s.jsx(D,{invoice:z,isDuplicate:!0}),s.jsx("div",{className:"mt-6 p-4 bg-mono-50 border-t border-mono-200 text-center",children:s.jsxs("button",{onClick:()=>B(!1),className:"flex items-center mx-auto px-6 py-3 bg-black text-white rounded-lg hover:bg-black transition-colors",children:[s.jsx(b,{className:"h-4 w-4 mr-2"}),"Назад к списку"]})})]}):s.jsx(o,{title:"Расходные накладные",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-mono-900",children:"Расходные накладные"}),s.jsx("p",{className:"text-mono-600",children:"Создание и управление расходными накладными"})]}),s.jsxs("button",{onClick:ve,className:"flex items-center px-4 py-2 bg-black text-white rounded-lg hover:bg-black",children:[s.jsx(d,{className:"h-4 w-4 mr-2"}),"Создать накладную"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center gap-4",children:[s.jsx("div",{className:"flex-1 max-w-lg",children:s.jsxs("div",{className:"relative",children:[s.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-mono-400"}),s.jsx("input",{type:"text",placeholder:"Поиск по номеру, покупателю, поставщику или объекту...",value:T,onChange:e=>W(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-mono-300 rounded-lg focus:ring-2 focus:ring-mono-500 focus:border-transparent"})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>U(!R),className:"flex items-center px-3 py-2 rounded-lg border transition-colors "+(R?"bg-black text-white border-blue-600":"bg-white text-mono-700 border-mono-300 hover:bg-mono-50"),children:[s.jsx(j,{className:"h-4 w-4 mr-2"}),"Фильтры",(E||Z||Y||Q)&&s.jsx("span",{className:"ml-2 bg-mono-500 text-white text-xs rounded-full px-2 py-1",children:[E,Z,Y,Q].filter(Boolean).length})]}),ne.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm text-mono-600",children:["Выбрано: ",ne.length]}),s.jsxs("button",{onClick:()=>{0!==ne.length&&window.confirm(`Вы уверены, что хотите удалить ${ne.length} накладных?`)&&(h(e=>e.filter(e=>!ne.includes(e.id))),ie([]))},className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[s.jsx(m,{className:"h-4 w-4 mr-2"}),"Удалить"]})]}),s.jsx(r,{viewMode:A,onViewModeChange:O})]})]}),R&&s.jsxs("div",{className:"bg-mono-50 p-4 rounded-lg border",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Поставщик"}),s.jsxs("select",{value:E,onChange:e=>G(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md focus:ring-2 focus:ring-mono-500",children:[s.jsx("option",{value:"",children:"Все поставщики"}),de.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Покупатель"}),s.jsxs("select",{value:Z,onChange:e=>K(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md focus:ring-2 focus:ring-mono-500",children:[s.jsx("option",{value:"",children:"Все покупатели"}),me.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Дата от"}),s.jsx("input",{type:"date",value:Y,onChange:e=>J(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md focus:ring-2 focus:ring-mono-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-mono-700 mb-1",children:"Дата до"}),s.jsx("input",{type:"date",value:Q,onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border border-mono-300 rounded-md focus:ring-2 focus:ring-mono-500"})]})]}),s.jsx("div",{className:"flex justify-end mt-4",children:s.jsx("button",{onClick:()=>{W(""),G(""),K(""),J(""),H(""),le(1)},className:"px-4 py-2 text-mono-600 hover:text-mono-800",children:"Очистить фильтры"})})]})]}),s.jsx("div",{className:"bg-mono-50 p-4 rounded-lg border border-mono-200",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"text-sm text-black",children:["Показано: ",xe.length," из ",ce.length," накладных",ce.length!==u.length&&s.jsxs("span",{className:"ml-2 text-black",children:["(отфильтровано из ",u.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-black",children:[s.jsx("span",{children:"Элементов на странице:"}),s.jsxs("select",{value:re,onChange:e=>ae(Number(e.target.value)),className:"px-2 py-1 border border-blue-300 rounded text-black",children:[s.jsx("option",{value:5,children:"5"}),s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:20,children:"20"}),s.jsx("option",{value:50,children:"50"})]})]})]})}),0===ce.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(p,{className:"h-16 w-16 text-mono-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-mono-900 mb-2",children:"Накладных не найдено"}),s.jsx("p",{className:"text-mono-500 mb-4",children:T||E||Z||Y||Q?"Попробуйте изменить критерии поиска или фильтры":"Создайте первую расходную накладную"}),!T&&!E&&!Z&&!Y&&!Q&&s.jsxs("button",{onClick:ve,className:"flex items-center px-4 py-2 bg-black text-white rounded-lg hover:bg-black mx-auto",children:[s.jsx(d,{className:"h-4 w-4 mr-2"}),"Создать накладную"]})]}):"list"===A?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{minWidth:"900px"},children:[s.jsx("thead",{className:"bg-mono-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider w-8",children:s.jsx("input",{type:"checkbox",checked:ne.length===xe.length&&xe.length>0,onChange:()=>{ne.length===xe.length?ie([]):ie(xe.map(e=>e.id))},className:"rounded border-mono-300 text-black focus:ring-mono-500 w-3 h-3"})}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider cursor-pointer hover:bg-mono-100 w-28",onClick:()=>he("invoiceNumber"),children:s.jsxs("div",{className:"flex items-center gap-1",children:["Номер / Дата",be("invoiceNumber")]})}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider cursor-pointer hover:bg-mono-100 w-32",onClick:()=>he("supplier"),children:s.jsxs("div",{className:"flex items-center gap-1",children:["Поставщик",be("supplier")]})}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider cursor-pointer hover:bg-mono-100 w-32",onClick:()=>he("customerName"),children:s.jsxs("div",{className:"flex items-center gap-1",children:["Покупатель",be("customerName")]})}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider w-36",children:"Объект доставки"}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider w-28",children:"Водитель / Авто"}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider cursor-pointer hover:bg-mono-100 w-20",onClick:()=>he("total"),children:s.jsxs("div",{className:"flex items-center gap-1",children:["Сумма",be("total")]})}),s.jsx("th",{className:"px-1 py-1 text-left text-xs font-medium text-mono-500 uppercase tracking-wider w-28",children:"Действия"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:xe.map(e=>s.jsxs("tr",{className:"hover:bg-mono-50 "+(ne.includes(e.id)?"bg-mono-50":""),children:[s.jsx("td",{className:"px-1 py-1 whitespace-nowrap",children:s.jsx("input",{type:"checkbox",checked:ne.includes(e.id),onChange:()=>{return t=e.id,void ie(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded border-mono-300 text-black focus:ring-mono-500 w-3 h-3"})}),s.jsx("td",{className:"px-1 py-1 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-mono-900 leading-none",children:e.invoiceNumber}),s.jsx("div",{className:"text-xs text-mono-500 leading-none",children:Ce(e.invoiceDate)})]})}),s.jsx("td",{className:"px-1 py-1",children:s.jsx("div",{className:"text-xs text-mono-900 leading-none",title:e.supplier,children:e.supplier})}),s.jsx("td",{className:"px-1 py-1",children:s.jsx("div",{className:"text-xs text-mono-900 leading-none",title:e.customerName,children:e.customerName})}),s.jsx("td",{className:"px-1 py-1",children:s.jsx("div",{className:"text-xs text-mono-900 leading-none",title:e.delivery.deliveryObject,children:e.delivery.deliveryObject})}),s.jsx("td",{className:"px-1 py-1 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-mono-900 leading-none",title:e.delivery.driverName,children:e.delivery.driverName}),s.jsx("div",{className:"text-xs text-mono-500 leading-none",title:e.delivery.vehicleNumber,children:e.delivery.vehicleNumber})]})}),s.jsx("td",{className:"px-1 py-1 whitespace-nowrap",children:s.jsx("div",{className:"text-xs font-medium text-mono-900 leading-none",children:e.total?ke(e.total):"—"})}),s.jsx("td",{className:"px-1 py-1 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-0.5",children:[s.jsx("button",{onClick:()=>Ne(e),className:"p-0.5 text-black hover:text-black hover:bg-mono-100 rounded",title:"Просмотр",children:s.jsx(g,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>je(e),className:"p-0.5 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-100 rounded",title:"Редактировать",children:s.jsx(N,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>pe(e),className:"p-0.5 text-mono-600 hover:text-mono-900 hover:bg-mono-100 rounded",title:"Дублировать",children:s.jsx(f,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>fe(e),className:"p-0.5 text-mono-600 hover:text-green-900 hover:bg-mono-100 rounded",title:"Печать",children:s.jsx(y,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>ye(),className:"p-0.5 text-purple-600 hover:text-purple-900 hover:bg-purple-100 rounded",title:"Экспорт PDF",children:s.jsx(w,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>ge(e.id),className:"p-0.5 text-mono-600 hover:text-red-900 hover:bg-red-100 rounded",title:"Удалить",children:s.jsx(m,{className:"h-3 w-3"})})]})})]},e.id))})]})})}),ue>1&&s.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-mono-200 sm:px-6",children:[s.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.jsx("button",{onClick:()=>le(e=>Math.max(e-1,1)),disabled:1===oe,className:"relative inline-flex items-center px-4 py-2 border border-mono-300 text-sm font-medium rounded-md text-mono-700 bg-white hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Предыдущая"}),s.jsx("button",{onClick:()=>le(e=>Math.min(e+1,ue)),disabled:oe===ue,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-mono-300 text-sm font-medium rounded-md text-mono-700 bg-white hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Следующая"})]}),s.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-mono-700",children:["Показано"," ",s.jsx("span",{className:"font-medium",children:(oe-1)*re+1})," ","-"," ",s.jsx("span",{className:"font-medium",children:Math.min(oe*re,ce.length)})," ","из"," ",s.jsx("span",{className:"font-medium",children:ce.length})," ","результатов"]})}),s.jsx("div",{children:s.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[s.jsx("button",{onClick:()=>le(e=>Math.max(e-1,1)),disabled:1===oe,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-mono-300 bg-white text-sm font-medium text-mono-500 hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(C,{className:"h-5 w-5"})}),Array.from({length:ue},(e,t)=>t+1).map(e=>1===e||e===ue||e>=oe-1&&e<=oe+1?s.jsx("button",{onClick:()=>le(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium "+(oe===e?"z-10 bg-mono-50 border-mono-500 text-black":"bg-white border-mono-300 text-mono-500 hover:bg-mono-50"),children:e},e):e===oe-2||e===oe+2?s.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-mono-300 bg-white text-sm font-medium text-mono-700",children:"..."},e):null),s.jsx("button",{onClick:()=>le(e=>Math.min(e+1,ue)),disabled:oe===ue,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-mono-300 bg-white text-sm font-medium text-mono-500 hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(k,{className:"h-5 w-5"})})]})})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:xe.map(e=>s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-mono-900",children:e.invoiceNumber}),s.jsx("p",{className:"text-sm text-mono-500",children:Ce(e.invoiceDate)})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-sm font-medium text-mono-900",children:e.total?ke(e.total):"—"})})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:e.customerName})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(p,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:e.delivery.deliveryObject})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(c,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:e.delivery.driverName})]}),s.jsxs("div",{className:"flex items-center text-sm text-mono-600",children:[s.jsx(x,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:e.delivery.vehicleNumber})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-mono-200",children:[s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>Ne(e),className:"p-2 text-black hover:bg-mono-50 rounded-md",title:"Просмотр",children:s.jsx(g,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>je(e),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-md",title:"Редактировать",children:s.jsx(N,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>pe(e),className:"p-2 text-mono-600 hover:bg-mono-50 rounded-md",title:"Дублировать",children:s.jsx(f,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>fe(e),className:"p-2 text-mono-600 hover:bg-green-50 rounded-md",title:"Печать",children:s.jsx(y,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>ye(),className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Экспорт PDF",children:s.jsx(w,{className:"h-4 w-4"})})]}),s.jsx("button",{onClick:()=>ge(e.id),className:"p-2 text-mono-600 hover:bg-red-50 rounded-md",title:"Удалить",children:s.jsx(m,{className:"h-4 w-4"})})]})]},e.id))}),ue>1&&s.jsxs("div",{className:"mt-6 bg-white px-4 py-3 flex items-center justify-between border border-mono-200 rounded-lg sm:px-6",children:[s.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.jsx("button",{onClick:()=>le(e=>Math.max(e-1,1)),disabled:1===oe,className:"relative inline-flex items-center px-4 py-2 border border-mono-300 text-sm font-medium rounded-md text-mono-700 bg-white hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Предыдущая"}),s.jsx("button",{onClick:()=>le(e=>Math.min(e+1,ue)),disabled:oe===ue,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-mono-300 text-sm font-medium rounded-md text-mono-700 bg-white hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Следующая"})]}),s.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-mono-700",children:["Показано"," ",s.jsx("span",{className:"font-medium",children:(oe-1)*re+1})," ","-"," ",s.jsx("span",{className:"font-medium",children:Math.min(oe*re,ce.length)})," ","из"," ",s.jsx("span",{className:"font-medium",children:ce.length})," ","результатов"]})}),s.jsx("div",{children:s.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[s.jsx("button",{onClick:()=>le(e=>Math.max(e-1,1)),disabled:1===oe,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-mono-300 bg-white text-sm font-medium text-mono-500 hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(C,{className:"h-5 w-5"})}),Array.from({length:ue},(e,t)=>t+1).map(e=>1===e||e===ue||e>=oe-1&&e<=oe+1?s.jsx("button",{onClick:()=>le(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium "+(oe===e?"z-10 bg-mono-50 border-mono-500 text-black":"bg-white border-mono-300 text-mono-500 hover:bg-mono-50"),children:e},e):e===oe-2||e===oe+2?s.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-mono-300 bg-white text-sm font-medium text-mono-700",children:"..."},e):null),s.jsx("button",{onClick:()=>le(e=>Math.min(e+1,ue)),disabled:oe===ue,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-mono-300 bg-white text-sm font-medium text-mono-500 hover:bg-mono-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(k,{className:"h-5 w-5"})})]})})]})]})]})]})})}export{B as default};
