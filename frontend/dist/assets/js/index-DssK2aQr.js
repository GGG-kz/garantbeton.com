const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["/assets/js/web-CY241Gcs.js","/assets/js/vendor-CPG67Noa.js","/assets/js/ui-DT0cN5GG.js","/assets/js/utils-CHM7ATol.js","/assets/js/forms-BH-hazHY.js","/assets/js/ProfilePage-jX5xAPzK.js","/assets/js/DriverProfilePage-0ifYEhhB.js","/assets/js/PricesPage-DTvgpJP8.js","/assets/js/Modal-_SIwUgx5.js","/assets/js/RequestsPage-J8Q2n9Fx.js","/assets/js/ViewToggle-BZCXPk9z.js","/assets/js/OrdersPage-BM-cmgGh.js","/assets/js/orders-wRWCNCfU.js","/assets/js/ServicePricesPage-Dho-OtZU.js","/assets/js/MessengerPage-Cq8N6ISr.js","/assets/js/ApiTestPage-Cq6Xk1Zm.js","/assets/js/UsersPage-qhANt4MW.js","/assets/js/ReportsPage-IPABLMgL.js","/assets/js/DirectoriesPage-DMNo2RZq.js","/assets/js/CounterpartiesPage-ZsAKfWm5.js","/assets/js/ConcreteGradesPage-B23vD3c4.js","/assets/js/WarehousesPage-CAiPNtNT.js","/assets/js/MaterialsPage-BYq72e22.js","/assets/js/DriversPage-B3xZ2wtX.js","/assets/js/VehiclesPage-B1SC29mA.js","/assets/js/ExpenseInvoicesPage-0rWT_9M4.js","/assets/js/ExpenseInvoicePrint-CKFMj2Ic.js","/assets/js/DriverInvoicesPage-BxJ82duH.js","/assets/js/ReceiptInvoicesPage-CL2TpRyx.js","/assets/js/ReceiptInvoicePrint-BKjFFOGi.js","/assets/js/DriverReceiptInvoicesPage-B10KVXZb.js","/assets/js/ScalesModelsPage-BpYlTUQi.js","/assets/js/DriverScalesPage-B1b5L2yZ.js","/assets/js/weighing-BTgEvgOj.js","/assets/js/WeighingPage-WyZooyRd.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,N as s,u as r,b as a,L as n,c as i,d as o,R as l,B as c}from"./vendor-CPG67Noa.js";import{c as d,D as m,X as h,T as x,L as u,U as p,A as f,E as g,a as b,b as j,C as v,S as N,d as w,M as y,H as k,F as E,e as S,f as _,g as O,B as P,h as R,i as I,I as C,j as L,k as A,l as D,R as T,m as z,n as U,o as V,p as $,q as J,r as W,s as q,t as F,P as B,u as H}from"./ui-DT0cN5GG.js";import{a as M}from"./utils-CHM7ATol.js";import{o as G,r as X,a as K,b as Y,s as Q,u as Z}from"./forms-BH-hazHY.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ee={exports:{}},te={},se=e,re=Symbol.for("react.element"),ae=Symbol.for("react.fragment"),ne=Object.prototype.hasOwnProperty,ie=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oe={key:!0,ref:!0,__self:!0,__source:!0};function le(e,t,s){var r,a={},n=null,i=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)ne.call(t,r)&&!oe.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:re,type:e,key:n,ref:i,props:a,_owner:ie.current}}te.Fragment=ae,te.jsx=le,te.jsxs=le,ee.exports=te;var ce=ee.exports,de={},me=t;de.createRoot=me.createRoot,de.hydrateRoot=me.hydrateRoot;const he={},xe=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),n=a?.nonce||a?.getAttribute("nonce");r=Promise.allSettled(t.map(t=>{if(t=function(e,t){return new URL(e,t).href}(t,s),t in he)return;he[t]=!0;const r=t.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(!!s)for(let s=e.length-1;s>=0;s--){const a=e[s];if(a.href===t&&(!r||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const i=document.createElement("link");return i.rel=r?"stylesheet":"modulepreload",r||(i.as="script"),i.crossOrigin="",i.href=t,n&&i.setAttribute("nonce",n),document.head.appendChild(i),r?new Promise((e,s)=>{i.addEventListener("load",e),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};function ue(e,t){let s;try{s=e()}catch(r){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=s.getItem(e))?t:null;return a instanceof Promise?a.then(r):r(a)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const pe=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>pe(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>pe(e)(s)}}},fe=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(s,r,a)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},i=!1;const o=new Set,l=new Set;let c;try{c=n.getStorage()}catch(f){}if(!c)return e((...e)=>{s(...e)},r,a);const d=pe(n.serialize),m=()=>{const e=n.partialize({...r()});let t;const s=d({state:e,version:n.version}).then(e=>c.setItem(n.name,e)).catch(e=>{t=e});if(t)throw t;return s},h=a.setState;a.setState=(e,t)=>{h(e,t),m()};const x=e((...e)=>{s(...e),m()},r,a);let u;const p=()=>{var e;if(!c)return;i=!1,o.forEach(e=>e(r()));const t=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,r()))||void 0;return pe(c.getItem.bind(c))(n.name).then(e=>{if(e)return n.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version)}}).then(e=>{var t;return u=n.merge(e,null!=(t=r())?t:x),s(u,!0),m()}).then(()=>{null==t||t(u,void 0),i=!0,l.forEach(e=>e(u))}).catch(e=>{null==t||t(void 0,e)})};return a.persist={setOptions:e=>{n={...n,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>p(),hasHydrated:()=>i,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},p(),u||x})(e,t):((e,t)=>(s,r,a)=>{let n={storage:ue(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},i=!1;const o=new Set,l=new Set;let c=n.storage;if(!c)return e((...e)=>{s(...e)},r,a);const d=()=>{const e=n.partialize({...r()});return c.setItem(n.name,{state:e,version:n.version})},m=a.setState;a.setState=(e,t)=>{m(e,t),d()};const h=e((...e)=>{s(...e),d()},r,a);let x;a.getInitialState=()=>h;const u=()=>{var e,t;if(!c)return;i=!1,o.forEach(e=>{var t;return e(null!=(t=r())?t:h)});const a=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=r())?e:h))||void 0;return pe(c.getItem.bind(c))(n.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)]}return[!1,void 0]}).then(e=>{var t;const[a,i]=e;if(x=n.merge(i,null!=(t=r())?t:h),s(x,!0),a)return d()}).then(()=>{null==a||a(x,void 0),x=r(),i=!0,l.forEach(e=>e(x))}).catch(e=>{null==a||a(void 0,e)})};return a.persist={setOptions:e=>{n={...n,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>u(),hasHydrated:()=>i,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},n.skipHydration||u(),x||h})(e,t),ge="http://localhost:4000/api",be=M.create({baseURL:ge,headers:{"Content-Type":"application/json"}});be.interceptors.request.use(e=>{const t=localStorage.getItem("auth-storage");if(t)try{const s=JSON.parse(t);s.state?.accessToken&&(e.headers.Authorization=`Bearer ${s.state.accessToken}`)}catch(s){}return e},e=>Promise.reject(e)),be.interceptors.response.use(e=>e,async e=>{const t=e.config;if(401===e.response?.status&&!t._retry){t._retry=!0;try{const e=localStorage.getItem("auth-storage");if(e){const s=JSON.parse(e);if(s.state?.refreshToken){const e=(await M.post(`${ge}/auth/refresh`,{refreshToken:s.state.refreshToken})).data.accessToken;return s.state.accessToken=e,localStorage.setItem("auth-storage",JSON.stringify(s)),t.headers.Authorization=`Bearer ${e}`,be(t)}}}catch(s){return localStorage.removeItem("auth-storage"),window.location.href="/login",Promise.reject(s)}}return Promise.reject(e)});const je={login:async e=>{try{return(await be.post("/auth/login",e)).data}catch(t){throw t}},register:async e=>(await be.post("/auth/register",e)).data,refreshToken:async e=>(await be.post("/auth/refresh",{refreshToken:e})).data,getProfile:async()=>(await be.get("/auth/profile")).data,driverLogin:async e=>(await be.post("/auth/driver/login",e)).data,registerDriver:async e=>{try{return(await be.post("/auth/driver/register",e)).data}catch(t){throw t}}};var ve=(e=>(e.DEVELOPER="developer",e.ADMIN="admin",e.MANAGER="manager",e.DISPATCHER="dispatcher",e.DRIVER="driver",e.SUPPLY="supply",e.ACCOUNTANT="accountant",e.DIRECTOR="director",e.OPERATOR="operator",e.COOK="cook",e))(ve||{});const Ne=d()(fe((e,t)=>({user:null,accessToken:null,refreshToken:null,isLoading:!1,isAuthenticated:!1,originalRole:null,login:async t=>{e({isLoading:!0});try{const s=await je.login(t);e({user:s.user,accessToken:s.accessToken,refreshToken:s.refreshToken,isAuthenticated:!0,isLoading:!1,originalRole:s.user.role===ve.DEVELOPER?ve.DEVELOPER:null})}catch(s){throw e({isLoading:!1}),s}},register:async t=>{e({isLoading:!0});try{const s=await je.register(t);e({user:s.user,accessToken:s.accessToken,refreshToken:s.refreshToken,isAuthenticated:!0,isLoading:!1,originalRole:s.user.role===ve.DEVELOPER?ve.DEVELOPER:null})}catch(s){throw e({isLoading:!1}),s}},logout:()=>{e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,originalRole:null})},initializeAuth:()=>{const s=t();s.accessToken&&s.user&&e({isAuthenticated:!0})},switchRole:s=>{const r=t();r.user&&r.originalRole===ve.DEVELOPER&&e({user:{...r.user,role:s}})},driverLogin:async t=>{e({isLoading:!0});try{const s=await je.driverLogin(t);e({user:s.user,accessToken:s.accessToken,refreshToken:s.refreshToken,isAuthenticated:!0,isLoading:!1,originalRole:null})}catch(s){throw e({isLoading:!1}),s}}}),{name:"auth-storage",partialize:e=>({user:e.user,accessToken:e.accessToken,refreshToken:e.refreshToken,isAuthenticated:e.isAuthenticated,originalRole:e.originalRole})}));function we({children:e}){const{isAuthenticated:t}=Ne();return t?ce.jsx(ce.Fragment,{children:e}):ce.jsx(s,{to:"/login",replace:!0})}function ye(){return ce.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:ce.jsxs("div",{className:"text-center animate-fade-in",children:[ce.jsxs("div",{className:"relative",children:[ce.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-mono-200"}),ce.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-black border-t-transparent absolute top-0 left-0"})]}),ce.jsx("p",{className:"mt-4 text-black font-semibold",children:"Загрузка..."})]})})}function ke(){const[t,s]=e.useState(null),[r,a]=e.useState(!1);e.useEffect(()=>{const e=e=>{e.preventDefault(),s(e),a(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);const n=()=>{a(!1)};return r?ce.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:ce.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-mono-200 p-4",children:[ce.jsxs("div",{className:"flex items-start justify-between mb-3",children:[ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(m,{className:"h-5 w-5 text-black"}),ce.jsx("h3",{className:"font-medium text-black",children:"Установить приложение"})]}),ce.jsx("button",{onClick:n,className:"text-mono-400 hover:text-mono-600",children:ce.jsx(h,{className:"h-4 w-4"})})]}),ce.jsx("p",{className:"text-sm text-mono-600 mb-4",children:"Установите приложение на свой рабочий стол для быстрого доступа"}),ce.jsxs("div",{className:"flex space-x-2",children:[ce.jsx("button",{onClick:async()=>{if(!t)return;t.prompt();const{outcome:e}=await t.userChoice;s(null),a(!1)},className:"flex-1 btn-primary text-sm py-2",children:"Установить"}),ce.jsx("button",{onClick:n,className:"flex-1 btn-secondary text-sm py-2",children:"Позже"})]})]})}):null}
/*! Capacitor: https://capacitorjs.com/ - MIT License */var Ee;!function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(Ee||(Ee={}));class Se extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const _e=e=>{const t=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},r=s.Plugins=s.Plugins||{},a=()=>null!==t?t.name:(e=>{var t,s;return(null==e?void 0:e.androidBridge)?"android":(null===(s=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===s?void 0:s.bridge)?"ios":"web"})(e),n=e=>{var t;return null===(t=s.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)},i=new Map;return s.convertFileSrc||(s.convertFileSrc=e=>e),s.getPlatform=a,s.handleError=t=>e.console.error(t),s.isNativePlatform=()=>"web"!==a(),s.isPluginAvailable=e=>{const t=i.get(e);return!!(null==t?void 0:t.platforms.has(a()))||!!n(e)},s.registerPlugin=(e,o={})=>{const l=i.get(e);if(l)return l.proxy;const c=a(),d=n(e);let m;const h=r=>{let a;const n=(...n)=>{const i=(async()=>(!m&&c in o?m=m="function"==typeof o[c]?await o[c]():o[c]:null!==t&&!m&&"web"in o&&(m=m="function"==typeof o.web?await o.web():o.web),m))().then(t=>{const i=((t,r)=>{var a,n;if(!d){if(t)return null===(n=t[r])||void 0===n?void 0:n.bind(t);throw new Se(`"${e}" plugin is not implemented on ${c}`,Ee.Unimplemented)}{const n=null==d?void 0:d.methods.find(e=>r===e.name);if(n)return"promise"===n.rtype?t=>s.nativePromise(e,r.toString(),t):(t,a)=>s.nativeCallback(e,r.toString(),t,a);if(t)return null===(a=t[r])||void 0===a?void 0:a.bind(t)}})(t,r);if(i){const e=i(...n);return a=null==e?void 0:e.remove,e}throw new Se(`"${e}.${r}()" is not implemented on ${c}`,Ee.Unimplemented)});return"addListener"===r&&(i.remove=async()=>a()),i};return n.toString=()=>`${r.toString()}() { [capacitor code] }`,Object.defineProperty(n,"name",{value:r,writable:!1,configurable:!1}),n},x=h("addListener"),u=h("removeListener"),p=(e,t)=>{const s=x({eventName:e},t),r=async()=>{const r=await s;u({eventName:e,callbackId:r},t)},a=new Promise(e=>s.then(()=>e({remove:r})));return a.remove=async()=>{await r()},a},f=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return d?p:x;case"removeListener":return u;default:return h(t)}}});return r[e]=f,i.set(e,{name:e,proxy:f,platforms:new Set([...Object.keys(o),...d?[c]:[]])}),f},s.Exception=Se,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},Oe=(e=>e.Capacitor=_e(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),Pe=Oe.registerPlugin;class Re{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),s&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const r=this.listeners[e];if(r)r.forEach(e=>e(t));else if(s){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new Oe.Exception(e,Ee.Unimplemented)}unavailable(e="not available"){return new Oe.Exception(e,Ee.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const r=s.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}const Ie=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Ce=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Le extends Re{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[s,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Ce(s).trim(),r=Ce(r).trim(),t[s]=r}),t}async setCookie(e){try{const t=Ie(e.key),s=Ie(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),n=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${r}; path=${a}; ${n};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Pe("CapacitorCookies",{web:()=>new Le});const Ae=(e,t={})=>{const s=Object.assign({method:e.method||"GET",headers:e.headers},t),r=((e={})=>{const t=Object.keys(e),s=Object.keys(e).map(e=>e.toLocaleLowerCase());return s.reduce((s,r,a)=>(s[r]=e[t[a]],s),{})})(e.headers),a=r["content-type"]||"";if("string"==typeof e.data)s.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[s,r]of Object.entries(e.data||{}))t.set(s,r);s.body=t.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,s)=>{t.append(s,e)});else for(const s of Object.keys(e.data))t.append(s,e.data[s]);s.body=t;const r=new Headers(s.headers);r.delete("content-type"),s.headers=r}else(a.includes("application/json")||"object"==typeof e.data)&&(s.body=JSON.stringify(e.data));return s};class De extends Re{async request(e){const t=Ae(e,e.webFetchExtra),s=((e,t=!0)=>e?Object.entries(e).reduce((e,s)=>{const[r,a]=s;let n,i;return Array.isArray(a)?(i="",a.forEach(e=>{n=t?encodeURIComponent(e):e,i+=`${r}=${n}&`}),i.slice(0,-1)):(n=t?encodeURIComponent(a):a,i=`${r}=${n}`),`${e}&${i}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),r=s?`${e.url}?${s}`:e.url,a=await fetch(r,t),n=a.headers.get("content-type")||"";let i,o,{responseType:l="text"}=a.ok?e:{};switch(n.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await a.blob(),i=await(async e=>new Promise((t,s)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>s(e),r.readAsDataURL(e)}))(o);break;case"json":i=await a.json();break;default:i=await a.text()}const c={};return a.headers.forEach((e,t)=>{c[t]=e}),{data:i,headers:c,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}var Te,ze;Pe("CapacitorHttp",{web:()=>new De}),function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Te||(Te={})),function(e){e.None="NONE",e.Slide="SLIDE",e.Fade="FADE"}(ze||(ze={}));const Ue=Pe("StatusBar");var Ve,$e;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Ve||(Ve={})),function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"}($e||($e={}));const Je=Pe("Keyboard"),We=Pe("Network",{web:()=>xe(()=>import("./web-CY241Gcs.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(e=>new e.NetworkWeb)}),qe=()=>{const[t,s]=e.useState(!1),[r,a]=e.useState(!0),[n,i]=e.useState(0);return e.useEffect(()=>{s(Oe.isNativePlatform()),Oe.isNativePlatform()&&(Ue.setStyle({style:Te.Dark}),Ue.setBackgroundColor({color:"#ffffff"}));return We.addListener("networkStatusChange",e=>{a(e.connected)}),"web"!==Oe.getPlatform()&&(Je.addListener("keyboardWillShow",e=>{i(e.keyboardHeight)}),Je.addListener("keyboardWillHide",()=>{i(0)})),()=>{We.removeAllListeners(),"web"!==Oe.getPlatform()&&Je.removeAllListeners()}},[]),{isNative:t,networkStatus:r,keyboardHeight:n,platform:Oe.getPlatform()}};var Fe=function(e,t){for(var s={};e.length;){var r=e[0],a=r.code,n=r.message,i=r.path.join(".");if(!s[i])if("unionErrors"in r){var o=r.unionErrors[0].errors[0];s[i]={message:o.message,type:o.code}}else s[i]={message:n,type:a};if("unionErrors"in r&&r.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),t){var l=s[i].types,c=l&&l[r.code];s[i]=K(i,t,s,a,c?[].concat(c,r.message):r.message)}e.shift()}return s},Be=function(e,t,s){return void 0===s&&(s={}),function(r,a,n){try{return Promise.resolve(function(a,i){try{var o=Promise.resolve(e["sync"===s.mode?"parse":"parseAsync"](r,t)).then(function(e){return n.shouldUseNativeValidation&&G({},n),{errors:{},values:s.raw?r:e}})}catch(X){return i(X)}return o&&o.then?o.then(void 0,i):o}(0,function(e){if(function(e){return Array.isArray(null==e?void 0:e.errors)}(e))return{values:{},errors:X(Fe(e.errors,!n.shouldUseNativeValidation&&"all"===n.criteriaMode),n)};throw e}))}catch(X){return Promise.reject(X)}}};const He=Y({login:Q().min(1,"Логин обязателен"),password:Q().min(1,"Пароль обязателен")});function Me(){const[t,s]=e.useState(!1),[a,n]=e.useState(""),[i,o]=e.useState("user"),{login:l,driverLogin:c,isLoading:d}=Ne(),m=r(),{isNative:h,keyboardHeight:j}=qe(),{register:v,handleSubmit:N,formState:{errors:w}}=Z({resolver:Be(He)});return ce.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white py-6 px-4 sm:px-6 lg:px-8",style:{paddingBottom:j>0?`${j+20}px`:"24px"},children:ce.jsxs("div",{className:"max-w-md w-full space-y-6 animate-fade-in",children:[ce.jsxs("div",{className:"text-center",children:[ce.jsx("div",{className:"mx-auto h-20 w-20 flex items-center justify-center rounded-2xl bg-black animate-scale-in",children:"driver"===i?ce.jsx(x,{className:"h-10 w-10 text-white"}):ce.jsx(u,{className:"h-10 w-10 text-white"})}),ce.jsx("h2",{className:"mt-6 text-center font-bold text-black "+(h?"text-2xl":"text-4xl"),children:"driver"===i?"Вход для водителей":"Вход в систему"}),ce.jsx("p",{className:"mt-3 text-center text-mono-600 font-semibold "+(h?"text-base":"text-lg"),children:"driver"===i?"Введите номер телефона и временный пароль":"Бетонный завод - автоматизация"})]}),ce.jsxs("div",{className:"flex rounded-2xl bg-mono-100 p-1.5 border-2 border-mono-200",children:[ce.jsxs("button",{type:"button",onClick:()=>o("user"),className:"flex-1 flex items-center justify-center px-4 py-3 text-sm font-semibold rounded-xl transition-all duration-300 "+("user"===i?"bg-black text-white":"text-mono-600 hover:text-black hover:bg-mono-50"),children:[ce.jsx(p,{className:"h-4 w-4 mr-2"}),"Сотрудники"]}),ce.jsxs("button",{type:"button",onClick:()=>o("driver"),className:"flex-1 flex items-center justify-center px-4 py-3 text-sm font-semibold rounded-xl transition-all duration-300 "+("driver"===i?"bg-black text-white":"text-mono-600 hover:text-black hover:bg-mono-50"),children:[ce.jsx(x,{className:"h-4 w-4 mr-2"}),"Водители"]})]}),ce.jsx("div",{className:"card p-8 animate-slide-up",children:ce.jsxs("form",{className:"space-y-6",onSubmit:N(async e=>{try{n(""),"driver"===i?await c(e):await l(e),m("/dashboard")}catch(t){n(t.response?.data?.message||"Ошибка входа в систему")}}),children:[a&&ce.jsxs("div",{className:"bg-gradient-to-r from-danger-50 to-danger-100 border border-danger-200 rounded-2xl p-4 flex items-center space-x-3 animate-slide-down",children:[ce.jsx("div",{className:"p-1 bg-danger-200 rounded-full",children:ce.jsx(f,{className:"h-4 w-4 text-danger-600"})}),ce.jsx("span",{className:"text-danger-700 text-sm font-medium",children:a})]}),ce.jsxs("div",{className:"space-y-5",children:[ce.jsxs("div",{children:[ce.jsx("label",{htmlFor:"login",className:"block text-sm font-semibold text-black mb-2",children:"Логин"}),ce.jsx("input",{...v("login"),type:"text",autoComplete:"username",className:"input-field",placeholder:"driver"===i?"Введите номер телефона (8XXXXXXXXXX)":"Введите логин"}),w.login&&ce.jsx("p",{className:"mt-2 text-sm text-danger-600 font-medium",children:w.login.message})]}),ce.jsxs("div",{children:[ce.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-black mb-2",children:"Пароль"}),ce.jsxs("div",{className:"relative",children:[ce.jsx("input",{...v("password"),type:t?"text":"password",autoComplete:"current-password",className:"input-field pr-12",placeholder:"driver"===i?"Введите временный пароль":"Введите пароль"}),ce.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-4 flex items-center text-mono-400 hover:text-mono-600 transition-colors duration-300",onClick:()=>s(!t),children:t?ce.jsx(g,{className:"h-5 w-5"}):ce.jsx(b,{className:"h-5 w-5"})})]}),w.password&&ce.jsx("p",{className:"mt-2 text-sm text-danger-600 font-medium",children:w.password.message})]})]}),ce.jsx("div",{className:"pt-2",children:ce.jsx("button",{type:"submit",disabled:d,className:"w-full btn-primary btn-lg",children:d?ce.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[ce.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),ce.jsx("span",{children:"Вход..."})]}):ce.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[ce.jsx(u,{className:"h-5 w-5"}),ce.jsx("span",{children:"Войти"})]})})})]})}),ce.jsxs("div",{className:"card-primary animate-fade-in",children:[ce.jsxs("h3",{className:"text-sm font-semibold text-black mb-3 flex items-center",children:[ce.jsx("div",{className:"w-2 h-2 bg-black rounded-full mr-2"}),"Тестовые аккаунты"]}),ce.jsx("div",{className:"grid grid-cols-1 gap-2 text-xs text-mono-600",children:[{login:"developer",password:"developer123",role:"Developer"},{login:"admin",password:"admin123",role:"Admin"},{login:"manager",password:"manager123",role:"Manager"},{login:"dispatcher",password:"dispatcher123",role:"Dispatcher"},{login:"driver",password:"driver123",role:"Driver"}].map((e,t)=>ce.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded-lg border-2 border-mono-200 hover:border-mono-300 transition-colors duration-300",children:[ce.jsxs("span",{className:"font-mono",children:[e.login," / ",e.password]}),ce.jsx("span",{className:"badge-primary",children:e.role})]},t))})]})]})})}const Ge={[ve.DEVELOPER]:"Разработчик",[ve.ADMIN]:"Администратор",[ve.MANAGER]:"Менеджер",[ve.DISPATCHER]:"Диспетчер",[ve.DRIVER]:"Водитель",[ve.SUPPLY]:"Снабженец",[ve.ACCOUNTANT]:"Бухгалтер",[ve.DIRECTOR]:"Директор",[ve.OPERATOR]:"Оператор",[ve.COOK]:"Повар"};function Xe(){const[t,s]=e.useState(!1),{user:r,originalRole:a,switchRole:n}=Ne();if(!r||a!==ve.DEVELOPER)return null;return ce.jsxs("div",{className:"relative",children:[ce.jsxs("button",{onClick:()=>s(!t),className:"flex items-center space-x-2 px-3 py-2 bg-white hover:bg-mono-100 border-2 border-mono-300 hover:border-black rounded-lg transition-all duration-200",children:[ce.jsx(j,{className:"h-4 w-4 text-black"}),ce.jsxs("span",{className:"text-sm font-medium text-black",children:[Ge[r.role]," ",a===ve.DEVELOPER&&r.role!==ve.DEVELOPER&&"(разработчик)"]}),ce.jsx(v,{className:"h-4 w-4 text-black"})]}),t&&ce.jsxs(ce.Fragment,{children:[ce.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),ce.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-large border-2 border-mono-300 z-20",children:ce.jsx("div",{className:"py-1",children:Object.entries(Ge).map(([e,t])=>ce.jsx("button",{onClick:()=>(e=>{n(e),s(!1)})(e),className:"w-full text-left px-4 py-2 text-sm hover:bg-mono-100 transition-colors duration-200 "+(r.role===e?"bg-black text-white":"text-black"),children:t},e))})})]})]})}function Ke(){const[t,s]=e.useState(!1),{user:a,logout:n}=Ne(),i=r();if(!a)return null;const o=a.fullName||a.login;return ce.jsxs("div",{className:"relative",children:[ce.jsxs("button",{onClick:()=>s(!t),className:"flex items-center space-x-3 px-3 py-2 bg-white hover:bg-mono-100 rounded-lg border-2 border-mono-300 hover:border-black transition-all duration-200",children:[ce.jsx("div",{className:"relative",children:a.avatar?ce.jsx("img",{src:a.avatar,alt:o,className:"h-8 w-8 rounded-full object-cover"}):ce.jsx("div",{className:"h-8 w-8 rounded-full bg-black flex items-center justify-center",children:ce.jsx("span",{className:"text-sm font-medium text-white",children:(l=a.fullName,l?l.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):a.login.slice(0,2).toUpperCase())})})}),ce.jsxs("div",{className:"flex flex-col items-start",children:[ce.jsx("span",{className:"text-sm font-medium text-black",children:o}),ce.jsx("span",{className:"text-xs text-mono-500",children:a.role})]}),ce.jsx(v,{className:"h-4 w-4 text-black"})]}),t&&ce.jsxs(ce.Fragment,{children:[ce.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),ce.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-large border-2 border-mono-300 z-20",children:ce.jsxs("div",{className:"py-1",children:[ce.jsxs("button",{onClick:()=>{"driver"===a.role?i("/driver-profile"):i("/profile"),s(!1)},className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-black hover:bg-mono-100 transition-colors duration-200",children:[ce.jsx(j,{className:"h-4 w-4"}),ce.jsx("span",{children:"Профиль"})]}),ce.jsxs("button",{onClick:()=>{i("/settings"),s(!1)},className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-black hover:bg-mono-100 transition-colors duration-200",children:[ce.jsx(N,{className:"h-4 w-4"}),ce.jsx("span",{children:"Настройки"})]}),ce.jsx("div",{className:"border-t border-mono-200 my-1"}),ce.jsxs("button",{onClick:()=>{n(),i("/login"),s(!1)},className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-black hover:bg-mono-200 transition-colors duration-200",children:[ce.jsx(w,{className:"h-4 w-4"}),ce.jsx("span",{children:"Выйти"})]})]})})]})]});var l}const Ye=[{path:"/dashboard",icon:k,label:"Главная"},{path:"/orders",icon:E,label:"Заказы"},{path:"/directories",icon:p,label:"Справочники"},{path:"/weighing",icon:S,label:"Взвешивание"},{path:"/messenger",icon:_,label:"Сообщения"},{path:"/profile",icon:N,label:"Профиль"}];function Qe(){const[t,s]=e.useState(!1),r=a(),i=()=>s(!t);return ce.jsxs(ce.Fragment,{children:[ce.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-mono-200 px-4 py-3",children:ce.jsxs("div",{className:"flex items-center justify-between",children:[ce.jsx("h1",{className:"text-lg font-semibold text-black",children:"BetonApp"}),ce.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-mono-100",children:t?ce.jsx(h,{className:"h-5 w-5"}):ce.jsx(y,{className:"h-5 w-5"})})]})}),ce.jsxs("div",{className:"fixed inset-0 z-40 transform transition-transform duration-300 "+(t?"translate-x-0":"-translate-x-full"),children:[ce.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:i}),ce.jsx("div",{className:"relative w-64 h-full bg-white shadow-xl",children:ce.jsxs("div",{className:"p-6",children:[ce.jsx("h2",{className:"text-xl font-bold text-black mb-6",children:"Навигация"}),ce.jsx("nav",{className:"space-y-2",children:Ye.map(e=>{const t=e.icon,s=r.pathname===e.path;return ce.jsxs(n,{to:e.path,onClick:i,className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors "+(s?"bg-black text-white":"text-mono-700 hover:bg-mono-100"),children:[ce.jsx(t,{className:"h-5 w-5"}),ce.jsx("span",{className:"font-medium",children:e.label})]},e.path)})})]})})]}),ce.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-30 bg-white border-t border-mono-200",children:ce.jsx("div",{className:"grid grid-cols-4 gap-1",children:Ye.slice(0,4).map(e=>{const t=e.icon,s=r.pathname===e.path;return ce.jsxs(n,{to:e.path,className:"flex flex-col items-center py-2 px-1 transition-colors "+(s?"text-black":"text-mono-500"),children:[ce.jsx(t,{className:"h-5 w-5 mb-1"}),ce.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.path)})})})]})}function Ze({children:e,showNavigation:t=!0}){const{isNative:s,keyboardHeight:r}=qe();return ce.jsxs("div",{className:"min-h-screen bg-mono-50",children:[t&&ce.jsx(Qe,{}),ce.jsx("main",{className:""+(t?"pt-16 pb-20":""),style:{paddingBottom:r>0?`${r}px`:t?"80px":"0"},children:ce.jsx("div",{className:"container mx-auto px-4 py-4",children:e})}),s&&ce.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-black to-mono-600 z-50"})]})}function et({to:e="/dashboard",className:t=""}){const s=r();return ce.jsxs("button",{onClick:()=>{s(e||-1)},className:`group inline-flex items-center space-x-3 px-6 py-3 bg-white hover:bg-black text-black hover:text-white border-2 border-black rounded-lg font-semibold transition-all duration-300 hover:scale-105 active:scale-95 shadow-sm hover:shadow-lg ${t}`,children:[ce.jsx("div",{className:"p-1 bg-black group-hover:bg-white rounded-full transition-colors duration-300",children:ce.jsx(O,{className:"h-4 w-4 text-white group-hover:text-black group-hover:-translate-x-1 transition-all duration-300"})}),ce.jsx("span",{className:"text-sm",children:"Назад"})]})}function tt({children:e,title:t,subtitle:s,backTo:r="/dashboard",showBackButton:a=!0}){return ce.jsx("div",{className:"min-h-screen bg-white",children:ce.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[a&&ce.jsx("div",{className:"mb-6 animate-slide-up",children:ce.jsx(et,{to:r})}),ce.jsx("div",{className:"mb-8 animate-fade-in",children:ce.jsxs("div",{className:"card-primary p-8 text-center",children:[ce.jsx("h1",{className:"text-4xl font-bold text-black",children:t}),s&&ce.jsx("p",{className:"text-mono-600 mt-3 text-lg font-semibold",children:s})]})}),ce.jsx("div",{className:"animate-slide-up",children:e})]})})}function st({children:t,showNavigation:s=!0}){const{isNative:r}=qe(),[a,n]=e.useState(!1);return e.useEffect(()=>{const e=()=>{n(window.innerWidth<768||r)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[r]),a||r?ce.jsx(Ze,{showNavigation:s,children:t}):ce.jsx(tt,{title:"",subtitle:"",children:t})}const rt="beton_app_data_version",at=Date.now().toString(),nt=()=>{localStorage.setItem(rt,at)},it=()=>{Object.keys(localStorage).forEach(e=>{(e.startsWith("beton_")||e.includes("counterparties")||e.includes("concreteGrades"))&&localStorage.removeItem(e)}),nt()},ot=()=>localStorage.getItem(rt)!==at&&(nt(),!0);function lt(t,s){const[r,a]=e.useState(()=>{try{ot();const e=window.localStorage.getItem(t);if(e){return JSON.parse(e)}return s}catch(e){return s}});return[r,e=>{try{const s=e instanceof Function?e(r):e;a(s),window.localStorage.setItem(t,JSON.stringify(s))}catch(s){}}]}function ct(){const[e]=lt("counterparties",[]),[t]=lt("concreteGrades",[]),[s]=lt("warehouses",[]),[r]=lt("materials",[]),[a]=lt("drivers",[]),[n]=lt("vehicles",[]),[i]=lt("orders",[]),[o]=lt("expenseInvoices",[]),[l]=lt("internalRequests",[]),[c]=lt("additionalServices",[]),[d]=lt("prices",[]),[m]=lt("adminUsers",[]),[h]=lt("servicePrices",[]),x=e=>({total:e.length,active:e.filter(e=>!1!==e.isActive).length});return{counterparties:x(e),concreteGrades:x(t),warehouses:x(s),materials:x(r),drivers:x(a),vehicles:x(n),orders:x(i),expenseInvoices:x(o),internalRequests:x(l),additionalServices:x(c),prices:x(d),adminUsers:x(m),servicePrices:x(h)}}function dt(e){return ct()[e]||{total:0,active:0}}function mt(){const[t,s]=lt("notifications",[]),[r,a]=e.useState(0);e.useEffect(()=>{const e=t.filter(e=>!e.isRead).length;a(e)},[t]);const n=e=>{const t={...e,id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:(new Date).toISOString(),isRead:!1};return s(e=>[t,...e]),window.Notification&&"granted"===window.Notification.permission&&new window.Notification(t.title,{body:t.message,icon:"/favicon.ico"}),t};return e.useEffect(()=>{window.Notification&&"default"===window.Notification.permission&&window.Notification.requestPermission()},[]),{notifications:t,unreadCount:r,addNotification:n,markAsRead:e=>{s(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))},markAllAsRead:()=>{s(e=>e.map(e=>({...e,isRead:!0})))},clearNotifications:()=>{s([])},notifyRole:(e,t,s,r)=>{["dispatcher","accountant","director","manager"].includes(e)&&n({title:t,message:s,type:"info",userId:"",role:e,relatedOrderId:r.orderId,relatedInvoiceId:r.invoiceId,priority:"medium"})}}}const ht=()=>{let e=0;return["prices","additionalServices","internalRequests","servicePrices"].forEach(t=>{const s=localStorage.getItem(t);if(s)try{JSON.parse(s).length;localStorage.removeItem(t),e++}catch(r){}}),Object.keys(localStorage).forEach(e=>{}),e},xt=()=>{let e=0;return["prices","additionalServices","internalRequests","servicePrices"].forEach(t=>{const s=localStorage.getItem(t);if(s)try{const t=JSON.parse(s),r=t.length||0;r>0&&t.length,e+=r}catch(r){}}),e},ut=Object.freeze(Object.defineProperty({__proto__:null,checkSpecificData:xt,clearSpecificData:ht},Symbol.toStringTag,{value:"Module"})),pt=()=>{const e=Object.keys(localStorage);e.forEach(e=>{});const t=["auth-storage","beton_app_data_version"];let s=0;e.forEach(e=>{if(!t.includes(e))try{localStorage.removeItem(e),s++}catch(r){}});return Object.keys(localStorage).forEach(e=>{}),s},ft=()=>{const e=Object.keys(localStorage);let t=0;return e.forEach(e=>{try{const s=localStorage.getItem(e);if(s){const e=JSON.parse(s);if(Array.isArray(e))t+=e.length;else if("object"==typeof e){Object.keys(e)}}}catch(s){}}),t},gt=async()=>{try{if(localStorage.clear(),sessionStorage.clear(),"indexedDB"in window)try{const e=await indexedDB.databases();for(const t of e)t.name&&indexedDB.deleteDatabase(t.name)}catch(e){}if("caches"in window){const e=await caches.keys();for(const t of e)await caches.delete(t)}if("serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistrations();for(const t of e)await t.unregister()}setTimeout(()=>{window.location.reload()},1e3)}catch(e){}},bt=async()=>{try{Object.keys(localStorage).forEach(e=>{});if(Object.keys(sessionStorage).forEach(e=>{}),"indexedDB"in window)try{(await indexedDB.databases()).forEach(e=>{})}catch(e){}if("caches"in window){(await caches.keys()).forEach(e=>{})}if("serviceWorker"in navigator){(await navigator.serviceWorker.getRegistrations()).forEach(e=>{})}}catch(e){}},jt=({isOpen:t,onClose:s})=>{const{user:r}=Ne(),{notifications:a,unreadCount:n,markAsRead:i,markAllAsRead:o,clearNotifications:l}=mt(),[c,d]=e.useState("all");if(!t)return null;const m=a.filter(e=>{const t=!e.role||e.role===r?.role,s="all"===c||!e.isRead;return t&&s}),x=e=>{switch(e){case"success":return ce.jsx(D,{className:"w-5 h-5 text-black"});case"warning":return ce.jsx(A,{className:"w-5 h-5 text-mono-700"});case"error":return ce.jsx(L,{className:"w-5 h-5 text-mono-800"});default:return ce.jsx(C,{className:"w-5 h-5 text-mono-600"})}},u=e=>{switch(e){case"high":return"border-l-black";case"medium":return"border-l-mono-700";default:return"border-l-mono-500"}},p=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime();return s<6e4?"Только что":s<36e5?`${Math.floor(s/6e4)} мин назад`:s<864e5?`${Math.floor(s/36e5)} ч назад`:t.toLocaleDateString("ru-RU")};return ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:ce.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-hidden border-2 border-mono-300",children:[ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-mono-200",children:[ce.jsxs("div",{className:"flex items-center space-x-3",children:[ce.jsx(P,{className:"w-6 h-6 text-black"}),ce.jsxs("h2",{className:"text-xl font-semibold text-black",children:["Уведомления",n>0&&ce.jsx("span",{className:"ml-2 bg-black text-white text-xs px-2 py-1 rounded-full",children:n})]})]}),ce.jsx("button",{onClick:s,className:"text-mono-400 hover:text-black",children:ce.jsx(h,{className:"w-6 h-6"})})]}),ce.jsx("div",{className:"p-4 border-b border-mono-200 bg-mono-50",children:ce.jsxs("div",{className:"flex items-center justify-between",children:[ce.jsxs("div",{className:"flex space-x-2",children:[ce.jsx("button",{onClick:()=>d("all"),className:"px-3 py-1 text-sm rounded-lg "+("all"===c?"bg-black text-white":"bg-white text-black border-2 border-mono-300"),children:"Все"}),ce.jsx("button",{onClick:()=>d("unread"),className:"px-3 py-1 text-sm rounded-lg "+("unread"===c?"bg-black text-white":"bg-white text-black border-2 border-mono-300"),children:"Непрочитанные"})]}),ce.jsxs("div",{className:"flex space-x-2",children:[ce.jsxs("button",{onClick:o,className:"flex items-center space-x-1 px-3 py-1 text-sm text-black bg-mono-100 rounded-lg hover:bg-mono-200 border-2 border-mono-300",children:[ce.jsx(R,{className:"w-4 h-4"}),ce.jsx("span",{children:"Прочитать все"})]}),ce.jsxs("button",{onClick:l,className:"flex items-center space-x-1 px-3 py-1 text-sm text-white bg-mono-800 rounded-lg hover:bg-black border-2 border-mono-800",children:[ce.jsx(I,{className:"w-4 h-4"}),ce.jsx("span",{children:"Очистить"})]})]})]})}),ce.jsx("div",{className:"overflow-y-auto max-h-96",children:0===m.length?ce.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-mono-500",children:[ce.jsx(P,{className:"w-12 h-12 mb-4 text-mono-300"}),ce.jsx("p",{className:"text-lg font-medium text-black",children:"Нет уведомлений"}),ce.jsx("p",{className:"text-sm",children:"unread"===c?"Все уведомления прочитаны":"Уведомления появятся здесь"})]}):ce.jsx("div",{className:"divide-y divide-mono-200",children:m.map(e=>ce.jsx("div",{className:"p-4 hover:bg-mono-50 transition-colors "+(e.isRead?"":"bg-mono-100"),children:ce.jsxs("div",{className:`flex items-start space-x-3 border-l-4 pl-4 ${u(e.priority)}`,children:[ce.jsx("div",{className:"flex-shrink-0 mt-0.5",children:x(e.type)}),ce.jsxs("div",{className:"flex-1 min-w-0",children:[ce.jsxs("div",{className:"flex items-center justify-between",children:[ce.jsx("h3",{className:"text-sm font-medium "+(e.isRead?"text-mono-700":"text-black"),children:e.title}),ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx("span",{className:"text-xs text-mono-500",children:p(e.createdAt)}),!e.isRead&&ce.jsx("button",{onClick:()=>i(e.id),className:"text-black hover:text-mono-800",title:"Отметить как прочитанное",children:ce.jsx(b,{className:"w-4 h-4"})})]})]}),ce.jsx("p",{className:"text-sm mt-1 "+(e.isRead?"text-mono-600":"text-mono-800"),children:e.message}),e.relatedOrderId&&ce.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs text-mono-600",children:[ce.jsxs("span",{children:["Заказ #",e.relatedOrderId]}),e.relatedInvoiceId&&ce.jsxs("span",{children:["• Накладная #",e.relatedInvoiceId]})]})]})]})},e.id))})})]})})};function vt(){const{user:t}=Ne(),s=r(),[a]=lt("internalRequests",[]),n=ct(),{unreadCount:i,addNotification:o}=mt(),[l,c]=e.useState(!1);if(!t)return null;a.some(e=>e.userId===t.id),["director","accountant","supply"].includes(t.role);const d=(e=>{switch(e){case ve.DEVELOPER:return{title:"Разработчик",description:"Полный доступ к системе с возможностью переключения ролей",icon:H,color:"text-black",bgColor:"bg-mono-100"};case ve.ADMIN:return{title:"Администратор",description:"Управление пользователями и системными настройками",icon:N,color:"text-black",bgColor:"bg-mono-100"};case ve.MANAGER:return{title:"Менеджер",description:"Управление производством и планированием заказов",icon:$,color:"text-black",bgColor:"bg-mono-100"};case ve.DISPATCHER:return{title:"Диспетчер",description:"Координация доставки и управление транспортом",icon:x,color:"text-black",bgColor:"bg-mono-100"};case ve.DRIVER:return{title:"Водитель",description:"Управление доставкой и отслеживание маршрутов",icon:x,color:"text-black",bgColor:"bg-mono-100"};case ve.SUPPLY:return{title:"Снабженец",description:"Управление поставками сырья и материалов",icon:B,color:"text-black",bgColor:"bg-mono-100"};case ve.ACCOUNTANT:return{title:"Бухгалтер",description:"Финансовый учет и отчетность",icon:F,color:"text-black",bgColor:"bg-mono-100"};case ve.DIRECTOR:return{title:"Директор",description:"Общее руководство и стратегическое планирование",icon:p,color:"text-black",bgColor:"bg-mono-100"};case ve.OPERATOR:return{title:"Оператор",description:"Работа с материалами, марками бетона, заявками и мессенджером",icon:q,color:"text-black",bgColor:"bg-mono-100"};case ve.COOK:return{title:"Повар",description:"Подача заявок на продукты и инвентарь, доступ к мессенджеру",icon:W,color:"text-black",bgColor:"bg-mono-100"};default:return{title:"Пользователь",description:"Базовый доступ к системе",icon:j,color:"text-black",bgColor:"bg-mono-100"}}})(t.role),m=d.icon;return ce.jsxs(st,{children:[ce.jsx("div",{className:"hidden md:block",children:ce.jsx("header",{className:"bg-white border-b-2 border-black mb-8",children:ce.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:ce.jsxs("div",{className:"flex justify-between items-center h-16",children:[ce.jsx("div",{className:"flex items-center",children:ce.jsx("h1",{className:"text-xl font-bold text-black",children:"Бетонный завод"})}),ce.jsxs("div",{className:"flex items-center space-x-4",children:[ce.jsxs("button",{onClick:()=>c(!0),className:"relative p-2 text-mono-600 hover:text-black focus:outline-none focus:ring-2 focus:ring-mono-500 focus:ring-offset-2 rounded-lg hover:bg-mono-100 transition-all duration-300",title:"Уведомления",children:[ce.jsx(P,{className:"w-6 h-6"}),i>0&&ce.jsx("span",{className:"absolute -top-1 -right-1 bg-black text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold",children:i>9?"9+":i})]}),ce.jsx(Xe,{}),ce.jsx(Ke,{})]})]})})})}),ce.jsx("div",{className:"md:hidden mb-4",children:ce.jsxs("div",{className:"flex items-center justify-between",children:[ce.jsx("h1",{className:"text-lg font-bold text-black",children:"Главная"}),ce.jsxs("button",{onClick:()=>c(!0),className:"relative p-2 text-mono-600 hover:text-black rounded-lg",children:[ce.jsx(P,{className:"w-5 h-5"}),i>0&&ce.jsx("span",{className:"absolute -top-1 -right-1 bg-black text-white text-xs rounded-full h-4 w-4 flex items-center justify-center font-bold",children:i>9?"9+":i})]})]})}),ce.jsx("div",{className:"space-y-6",children:ce.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[ce.jsx("div",{className:"lg:col-span-1",children:ce.jsxs("div",{className:"card",children:[ce.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[ce.jsx("div",{className:`p-3 rounded-lg ${d.bgColor}`,children:ce.jsx(m,{className:`h-6 w-6 ${d.color}`})}),ce.jsxs("div",{children:[ce.jsx("h2",{className:"text-lg font-semibold text-black",children:d.title}),ce.jsx("p",{className:"text-sm text-mono-500",children:t.login})]})]}),ce.jsx("p",{className:"text-mono-600 text-sm leading-relaxed",children:d.description}),t.role===ve.DEVELOPER&&ce.jsxs("div",{className:"mt-4 space-y-3",children:[ce.jsx("div",{className:"p-3 bg-mono-50 border-2 border-mono-200 rounded-lg",children:ce.jsx("p",{className:"text-sm text-mono-700",children:"Используйте переключатель ролей выше для тестирования разных интерфейсов"})}),ce.jsx("button",{onClick:()=>{o({title:"Тестовое уведомление",message:"Это тестовое уведомление для проверки работы системы уведомлений",type:"info",userId:t.id,role:t.role,priority:"medium"})},className:"w-full btn-primary btn-sm",children:"Тест уведомления"}),ce.jsx("button",{onClick:()=>{window.confirm("Принудительно обновить кэш приложения? Это очистит все кэши и перезагрузит страницу.")&&(async()=>{if("serviceWorker"in navigator)try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}const e=await navigator.serviceWorker.getRegistration();e&&(await e.unregister(),window.location.reload())}catch(e){}})()},className:"w-full btn-danger btn-sm",children:"Принудительное обновление"}),ce.jsxs("div",{className:"border-t border-mono-200 pt-3 mt-3",children:[ce.jsx("h4",{className:"text-sm font-medium text-mono-700 mb-2",children:"Синхронизация данных"}),ce.jsx("button",{onClick:()=>{const e=(()=>{try{const e={counterparties:JSON.parse(localStorage.getItem("counterparties")||"[]"),concreteGrades:JSON.parse(localStorage.getItem("concreteGrades")||"[]"),warehouses:JSON.parse(localStorage.getItem("warehouses")||"[]"),materials:JSON.parse(localStorage.getItem("materials")||"[]"),drivers:JSON.parse(localStorage.getItem("drivers")||"[]"),vehicles:JSON.parse(localStorage.getItem("vehicles")||"[]"),orders:JSON.parse(localStorage.getItem("orders")||"[]"),expenseInvoices:JSON.parse(localStorage.getItem("expenseInvoices")||"[]"),internalRequests:JSON.parse(localStorage.getItem("internalRequests")||"[]"),prices:JSON.parse(localStorage.getItem("prices")||"[]"),additionalServices:JSON.parse(localStorage.getItem("additionalServices")||"[]"),notifications:JSON.parse(localStorage.getItem("notifications")||"[]"),exportDate:(new Date).toISOString(),version:"1.0.1"},t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),a=document.createElement("a");return a.href=r,a.download=`beton-app-data-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),"Данные успешно экспортированы"}catch(e){return"Ошибка при экспорте данных"}})();alert(e)},className:"w-full btn-success btn-sm mb-2",children:"Экспорт данных"}),ce.jsx("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files?.[0];if(t){const e=await(e=>new Promise(t=>{const s=new FileReader;s.onload=e=>{try{const s=e.target?.result,r=JSON.parse(s);if(r.version&&"1.0.1"!==r.version)return void t("Версия файла не совместима с текущей версией приложения");r.counterparties&&localStorage.setItem("counterparties",JSON.stringify(r.counterparties)),r.concreteGrades&&localStorage.setItem("concreteGrades",JSON.stringify(r.concreteGrades)),r.warehouses&&localStorage.setItem("warehouses",JSON.stringify(r.warehouses)),r.materials&&localStorage.setItem("materials",JSON.stringify(r.materials)),r.drivers&&localStorage.setItem("drivers",JSON.stringify(r.drivers)),r.vehicles&&localStorage.setItem("vehicles",JSON.stringify(r.vehicles)),r.orders&&localStorage.setItem("orders",JSON.stringify(r.orders)),r.expenseInvoices&&localStorage.setItem("expenseInvoices",JSON.stringify(r.expenseInvoices)),r.internalRequests&&localStorage.setItem("internalRequests",JSON.stringify(r.internalRequests)),r.prices&&localStorage.setItem("prices",JSON.stringify(r.prices)),r.additionalServices&&localStorage.setItem("additionalServices",JSON.stringify(r.additionalServices)),r.notifications&&localStorage.setItem("notifications",JSON.stringify(r.notifications)),t("Данные успешно импортированы")}catch(s){t("Ошибка при импорте данных: неверный формат файла")}},s.onerror=()=>{t("Ошибка при чтении файла")},s.readAsText(e)}))(t);alert(e),e.includes("успешно")&&window.location.reload()}},e.click()},className:"w-full btn-primary btn-sm mb-2",children:"Импорт данных"}),ce.jsx("button",{onClick:()=>{if(window.confirm("Очистить ВСЕ данные приложения? Это действие необратимо!")){const e=(()=>{try{return["counterparties","concreteGrades","warehouses","materials","drivers","vehicles","orders","expenseInvoices","internalRequests","prices","additionalServices","notifications"].forEach(e=>localStorage.removeItem(e)),"Все данные очищены"}catch(e){return"Ошибка при очистке данных"}})();alert(e),window.location.reload()}},className:"w-full btn-danger btn-sm",children:"Очистить все данные"})]}),ce.jsxs("div",{className:"text-xs text-mono-500 text-center mt-3",children:["Версия: ","1.0.1"]})]})]})}),ce.jsx("div",{className:"lg:col-span-2",children:ce.jsxs("div",{className:"card",children:[ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[ce.jsx("h3",{className:"text-lg font-semibold text-black",children:"Добро пожаловать в систему!"}),ce.jsxs("button",{onClick:()=>{it(),window.location.reload()},className:"btn-primary btn-sm flex items-center space-x-2",title:"Принудительно обновить данные и очистить кэш",children:[ce.jsx(T,{className:"h-4 w-4"}),ce.jsx("span",{children:"Обновить"})]})]}),ce.jsxs("div",{className:"space-y-6",children:[ce.jsxs("div",{className:"card-primary",children:[ce.jsx("h4",{className:"font-medium text-black mb-2",children:"Система успешно запущена!"}),ce.jsxs("p",{className:"text-sm text-mono-700",children:["Вы успешно вошли в систему автоматизации бетонного завода. Интерфейс адаптирован под вашу роль: ",ce.jsx("strong",{children:d.title})]})]}),ce.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[ce.jsxs("div",{onClick:()=>s("/directories"),className:"dashboard-card",children:[ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(z,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Справочники"})]}),ce.jsxs("div",{className:"dashboard-card-badge",children:[n.counterparties.total+n.concreteGrades.total+n.warehouses.total+n.materials.total+n.drivers.total+n.vehicles.total," записей"]})]}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Управление контрагентами, материалами, транспортом и другой номенклатурой"})]}),(t.role===ve.MANAGER||t.role===ve.DIRECTOR||t.role===ve.DISPATCHER||t.role===ve.ACCOUNTANT)&&ce.jsxs("div",{onClick:()=>s("/orders"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(U,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Заказы бетона"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Создание и управление заказами на производство и доставку бетона"})]}),t.role===ve.DISPATCHER&&ce.jsxs("div",{onClick:()=>s("/expense-invoices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(V,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Расходные накладные"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Создание и печать расходных накладных для отгрузки товара"})]}),t.role===ve.DISPATCHER&&ce.jsxs("div",{onClick:()=>s("/receipt-invoices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(E,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Приходные накладные"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Создание и печать приходных накладных для поступления товара"})]}),t.role===ve.DRIVER&&ce.jsxs("div",{onClick:()=>s("/driver-invoices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(x,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Мои накладные"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Просмотр накладных для доставки и маршрутная информация"})]}),t.role===ve.DRIVER&&ce.jsxs("div",{onClick:()=>s("/driver-receipt-invoices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(E,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Приходные накладные"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Создание приходных накладных и взвешивание материалов"})]}),ce.jsxs("div",{onClick:()=>s("/requests"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(E,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Внутренние заявки"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Создание и управление заявками на внутренние нужды"})]}),ce.jsxs("div",{onClick:()=>s("/messenger"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(_,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Мессенджер"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Внутренняя система общения между сотрудниками"})]}),t.role===ve.ADMIN&&ce.jsxs("div",{onClick:()=>s("/admin/users"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(p,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Пользователи"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Управление пользователями системы: создание, блокировка, редактирование"})]}),t.role===ve.ADMIN&&ce.jsxs("div",{onClick:()=>s("/admin/reports"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx($,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Отчёты"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Системные отчёты: активность пользователей, блокировки, аудит действий"})]}),("accountant"===t.role||"director"===t.role||"supply"===t.role)&&ce.jsxs("div",{onClick:()=>s("/prices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(J,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Цены"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Управление ценами для контрагентов на марки бетона и материалы"})]}),("manager"===t.role||"director"===t.role||"accountant"===t.role)&&ce.jsxs("div",{onClick:()=>s("/service-prices"),className:"dashboard-card",children:[ce.jsx("div",{className:"flex items-center justify-between mb-2",children:ce.jsxs("div",{className:"flex items-center space-x-2",children:[ce.jsx(N,{className:"dashboard-card-icon"}),ce.jsx("h4",{className:"dashboard-card-title",children:"Цены услуг"})]})}),ce.jsx("p",{className:"text-sm text-mono-700",children:"Управление ценами на дополнительные услуги (насос, добавки, доставка)"})]})]}),t.role===ve.DEVELOPER&&ce.jsx("div",{className:"space-y-4",children:ce.jsxs("div",{className:"p-4 bg-mono-50 border-2 border-mono-200 rounded-lg",children:[ce.jsx("h4",{className:"font-medium text-black mb-2",children:"Режим разработчика"}),ce.jsx("p",{className:"text-sm text-mono-700 mb-3",children:"У вас есть доступ к переключению ролей для тестирования различных сценариев использования. Попробуйте переключиться на другую роль с помощью выпадающего меню в шапке."}),ce.jsxs("div",{className:"space-y-2",children:[ce.jsxs("div",{className:"flex flex-wrap gap-2",children:[ce.jsx("button",{onClick:()=>{const e=xt();alert(`Найдено данных: ${e} записей. См. консоль для деталей.`)},className:"btn-secondary btn-xs",children:"Проверить конкретные данные"}),ce.jsx("button",{onClick:()=>{if(confirm("Удалить данные из изображений (цены, услуги, заявки)?")){const e=ht();alert(`Удалено ${e} ключей. Страница обновится через секунду.`),setTimeout(()=>window.location.reload(),1e3)}},className:"btn-danger btn-xs",children:"Очистить данные из изображений"})]}),ce.jsxs("div",{className:"flex flex-wrap gap-2",children:[ce.jsx("button",{onClick:()=>{const e=ft();alert(`ВСЕГО данных в системе: ${e} записей. См. консоль для деталей.`)},className:"btn-secondary btn-xs",children:"Проверить ВСЕ данные"}),ce.jsx("button",{onClick:async()=>{await bt(),alert("Проверка PWA кэша завершена. См. консоль для деталей.")},className:"btn-secondary btn-xs",children:"Проверить PWA кэш"})]}),ce.jsxs("div",{className:"flex flex-wrap gap-2",children:[ce.jsx("button",{onClick:()=>{if(confirm("ЯДЕРНАЯ ОЧИСТКА! Удалить ВСЕ данные кроме авторизации? Это действие нельзя отменить!")&&confirm("Вы уверены? Это удалит ВСЕ данные из системы!")){const e=pt();alert(`ЯДЕРНАЯ ОЧИСТКА ЗАВЕРШЕНА! Удалено ${e} ключей. Страница обновится.`),setTimeout(()=>window.location.reload(),2e3)}},className:"btn-danger btn-xs font-bold",children:"ЯДЕРНАЯ ОЧИСТКА"}),ce.jsx("button",{onClick:async()=>{confirm("ОЧИСТКА PWA КЭША! Удалить все кэши, Service Worker и данные? Это решит проблему с восстановлением данных!")&&confirm("Вы уверены? Это удалит ВСЕ кэши и данные!")&&(await gt(),alert("PWA КЭШ ОЧИЩЕН! Страница обновится."))},className:"btn-danger btn-xs font-bold",children:"ОЧИСТИТЬ PWA КЭШ"})]})]})]})})]})]})})]})}),ce.jsx(jt,{isOpen:l,onClose:()=>c(!1)})]})}const Nt=e.lazy(()=>xe(()=>import("./ProfilePage-jX5xAPzK.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url)),wt=e.lazy(()=>xe(()=>import("./DriverProfilePage-0ifYEhhB.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url)),yt=e.lazy(()=>xe(()=>import("./PricesPage-DTvgpJP8.js"),__vite__mapDeps([7,1,8,2,3,4]),import.meta.url)),kt=e.lazy(()=>xe(()=>import("./RequestsPage-J8Q2n9Fx.js"),__vite__mapDeps([9,1,8,2,10,3,4]),import.meta.url)),Et=e.lazy(()=>xe(()=>import("./OrdersPage-BM-cmgGh.js"),__vite__mapDeps([11,1,12,2,10,3,4]),import.meta.url)),St=e.lazy(()=>xe(()=>import("./ServicePricesPage-Dho-OtZU.js"),__vite__mapDeps([13,1,12,2,3,4]),import.meta.url)),_t=e.lazy(()=>xe(()=>import("./MessengerPage-Cq8N6ISr.js"),__vite__mapDeps([14,1,2,3,4]),import.meta.url)),Ot=e.lazy(()=>xe(()=>import("./ApiTestPage-Cq6Xk1Zm.js"),__vite__mapDeps([15,1,2,3,4]),import.meta.url)),Pt=e.lazy(()=>xe(()=>import("./UsersPage-qhANt4MW.js"),__vite__mapDeps([16,1,8,2,10,3,4]),import.meta.url)),Rt=e.lazy(()=>xe(()=>import("./ReportsPage-IPABLMgL.js"),__vite__mapDeps([17,1,10,2,3,4]),import.meta.url)),It=e.lazy(()=>xe(()=>import("./DirectoriesPage-DMNo2RZq.js"),__vite__mapDeps([18,1,2,3,4]),import.meta.url)),Ct=e.lazy(()=>xe(()=>import("./CounterpartiesPage-ZsAKfWm5.js"),__vite__mapDeps([19,1,8,2,10,3,4]),import.meta.url)),Lt=e.lazy(()=>xe(()=>import("./ConcreteGradesPage-B23vD3c4.js"),__vite__mapDeps([20,1,8,2,3,4]),import.meta.url)),At=e.lazy(()=>xe(()=>import("./WarehousesPage-CAiPNtNT.js"),__vite__mapDeps([21,1,8,2,3,4]),import.meta.url)),Dt=e.lazy(()=>xe(()=>import("./MaterialsPage-BYq72e22.js"),__vite__mapDeps([22,1,8,2,3,4]),import.meta.url)),Tt=e.lazy(()=>xe(()=>import("./DriversPage-B3xZ2wtX.js"),__vite__mapDeps([23,1,8,2,3,4]),import.meta.url)),zt=e.lazy(()=>xe(()=>import("./VehiclesPage-B1SC29mA.js"),__vite__mapDeps([24,1,8,2,3,4]),import.meta.url)),Ut=e.lazy(()=>xe(()=>import("./ExpenseInvoicesPage-0rWT_9M4.js"),__vite__mapDeps([25,1,10,2,26,3,4]),import.meta.url)),Vt=e.lazy(()=>xe(()=>import("./DriverInvoicesPage-BxJ82duH.js"),__vite__mapDeps([27,1,10,2,26,3,4]),import.meta.url)),$t=e.lazy(()=>xe(()=>import("./ReceiptInvoicesPage-CL2TpRyx.js"),__vite__mapDeps([28,1,10,2,29,8,3,4]),import.meta.url)),Jt=e.lazy(()=>xe(()=>import("./DriverReceiptInvoicesPage-B10KVXZb.js"),__vite__mapDeps([30,1,8,2,29,3,4]),import.meta.url)),Wt=e.lazy(()=>xe(()=>import("./ScalesModelsPage-BpYlTUQi.js"),__vite__mapDeps([31,1,8,2,10,3,4]),import.meta.url)),qt=e.lazy(()=>xe(()=>import("./DriverScalesPage-B1b5L2yZ.js"),__vite__mapDeps([32,1,33,2,3,4]),import.meta.url)),Ft=e.lazy(()=>xe(()=>import("./WeighingPage-WyZooyRd.js"),__vite__mapDeps([34,1,33,2,3,4]),import.meta.url));function Bt(){const{initializeAuth:t,isLoading:r}=Ne(),{isNative:a,networkStatus:n}=qe();return e.useEffect(()=>{t()},[t]),r?ce.jsx(ye,{}):ce.jsxs("div",{className:"min-h-screen bg-white",children:[a&&!n&&ce.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-mono-800 text-white text-center py-2 text-sm",children:"Нет подключения к интернету"}),ce.jsx(e.Suspense,{fallback:ce.jsx(ye,{}),children:ce.jsxs(i,{children:[ce.jsx(o,{path:"/login",element:ce.jsx(Me,{})}),ce.jsx(o,{path:"/api-test",element:ce.jsx(Ot,{})}),ce.jsx(o,{path:"/dashboard",element:ce.jsx(we,{children:ce.jsx(vt,{})})}),ce.jsx(o,{path:"/profile",element:ce.jsx(we,{children:ce.jsx(Nt,{})})}),ce.jsx(o,{path:"/driver-profile",element:ce.jsx(we,{children:ce.jsx(wt,{})})}),ce.jsx(o,{path:"/prices",element:ce.jsx(we,{children:ce.jsx(yt,{})})}),ce.jsx(o,{path:"/requests",element:ce.jsx(we,{children:ce.jsx(kt,{})})}),ce.jsx(o,{path:"/orders",element:ce.jsx(we,{children:ce.jsx(Et,{})})}),ce.jsx(o,{path:"/service-prices",element:ce.jsx(we,{children:ce.jsx(St,{})})}),ce.jsx(o,{path:"/messenger",element:ce.jsx(we,{children:ce.jsx(_t,{})})}),ce.jsx(o,{path:"/admin/users",element:ce.jsx(we,{children:ce.jsx(Pt,{})})}),ce.jsx(o,{path:"/admin/reports",element:ce.jsx(we,{children:ce.jsx(Rt,{})})}),ce.jsx(o,{path:"/settings",element:ce.jsx(we,{children:ce.jsx(Nt,{})})}),ce.jsx(o,{path:"/directories",element:ce.jsx(we,{children:ce.jsx(It,{})})}),ce.jsx(o,{path:"/directories/counterparties",element:ce.jsx(we,{children:ce.jsx(Ct,{})})}),ce.jsx(o,{path:"/directories/concrete-grades",element:ce.jsx(we,{children:ce.jsx(Lt,{})})}),ce.jsx(o,{path:"/directories/warehouses",element:ce.jsx(we,{children:ce.jsx(At,{})})}),ce.jsx(o,{path:"/directories/materials",element:ce.jsx(we,{children:ce.jsx(Dt,{})})}),ce.jsx(o,{path:"/directories/drivers",element:ce.jsx(we,{children:ce.jsx(Tt,{})})}),ce.jsx(o,{path:"/directories/vehicles",element:ce.jsx(we,{children:ce.jsx(zt,{})})}),ce.jsx(o,{path:"/scales-models",element:ce.jsx(we,{children:ce.jsx(Wt,{})})}),ce.jsx(o,{path:"/driver-scales",element:ce.jsx(we,{children:ce.jsx(qt,{})})}),ce.jsx(o,{path:"/weighing",element:ce.jsx(we,{children:ce.jsx(Ft,{})})}),ce.jsx(o,{path:"/expense-invoices",element:ce.jsx(we,{children:ce.jsx(Ut,{})})}),ce.jsx(o,{path:"/receipt-invoices",element:ce.jsx(we,{children:ce.jsx($t,{})})}),ce.jsx(o,{path:"/driver-receipt-invoices",element:ce.jsx(we,{children:ce.jsx(Jt,{})})}),ce.jsx(o,{path:"/driver-invoices",element:ce.jsx(we,{children:ce.jsx(Vt,{})})}),ce.jsx(o,{path:"/",element:ce.jsx(s,{to:"/dashboard",replace:!0})})]})}),ce.jsx(ke,{})]})}"undefined"!=typeof window&&(window.clearAll=()=>{pt(),setTimeout(()=>window.location.reload(),1e3)},window.clearPwa=async()=>{await gt()},window.checkData=()=>{ft()},window.checkCache=async()=>{await bt()},window.clearSpecific=()=>{xe(async()=>{const{clearSpecificData:e}=await Promise.resolve().then(()=>ut);return{clearSpecificData:e}},void 0,import.meta.url).then(({clearSpecificData:e})=>{e(),setTimeout(()=>window.location.reload(),1e3)})}),(async()=>{if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistration();e&&await e.update()}catch(e){}})(),de.createRoot(document.getElementById("root")).render(ce.jsx(l.StrictMode,{children:ce.jsx(c,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:ce.jsx(Bt,{})})}));export{tt as P,st as R,ve as U,Re as W,lt as a,qe as b,je as c,dt as d,it as e,mt as f,ce as j,Ne as u};
